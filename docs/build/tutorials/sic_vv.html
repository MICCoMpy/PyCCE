<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
    <meta charset="utf-8"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>VV in SiC &mdash; pyCCE 0.5.1 documentation</title>


    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css"/>


    <link rel="shortcut icon" href="../_static/favicon.png"/>


    <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
    <![endif]-->


    <script type="text/javascript" id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
            src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="../_static/mathjax/tex-chtml.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})
    </script>

    <script type="text/javascript" src="../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>
    <link rel="next" title="Shallow donor in Si" href="si_shallow.html"/>
    <link rel="prev" title="NV Center in Diamond" href="diamond_nv.html"/>
</head>

<body class="wy-body-for-nav">


<div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">


                <a href="../index.html">


                    <img src="../_static/logo_white.svg" class="logo" alt="Logo"/>

                </a>


                <div role="search">
                    <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                        <input type="text" name="q" placeholder="Search docs"/>
                        <input type="hidden" name="check_keywords" value="yes"/>
                        <input type="hidden" name="area" value="default"/>
                    </form>
                </div>


            </div>


            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">


                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../theory.html">Theoretical
                        Background</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
                    <li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorials</a>
                        <ul class="current">
                            <li class="toctree-l2"><a class="reference internal" href="diamond_nv.html">NV Center in
                                Diamond</a></li>
                            <li class="toctree-l2 current"><a class="current reference internal" href="#">VV in SiC</a>
                                <ul>
                                    <li class="toctree-l3"><a class="reference internal" href="#Axial-kk-VV">Axial
                                        kk-VV</a>
                                        <ul>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Build-BathCell-from-the-ground">Build
                                                BathCell from the ground</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Read-Quantum-Espresso-output">Read Quantum
                                                Espresso output</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Set-up-CCE-Simulator">Set up CCE
                                                Simulator</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#FID-with-DFT-hyperfines">FID with DFT
                                                hyperfines</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#FID-with-hyperfines-from-point-dipole-approximation">FID
                                                with hyperfines from point dipole approximation</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Hahn-echo-comparison">Hahn-echo
                                                comparison</a></li>
                                        </ul>
                                    </li>
                                    <li class="toctree-l3"><a class="reference internal" href="#Basal-kh-VV-in-SiC">Basal
                                        kh-VV in SiC</a>
                                        <ul>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Setting-up-calculations">Setting up
                                                calculations</a></li>
                                            <li class="toctree-l4"><a class="reference internal" href="#FID-Decay">FID
                                                Decay</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Compare-the-two-results">Compare the two
                                                results</a></li>
                                            <li class="toctree-l4"><a class="reference internal"
                                                                      href="#Hahn-echo-decay">Hahn-echo decay</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="toctree-l2"><a class="reference internal" href="si_shallow.html">Shallow donor in
                                Si</a></li>
                            <li class="toctree-l2"><a class="reference internal" href="classical_noise.html">Correlation
                                function</a></li>
                        </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User Manual</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../bath.html">Generating the Spin
                        bath</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../simulator.html">Running the
                        simulations</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../parameters.html">Hamiltonian
                        parameters input</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../dft.html">Interfacing with DFT
                        output</a></li>
                </ul>
                <p class="caption"><span class="caption-text">Additional Documentation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../calculators.html">CCE Calculators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../hamiltonian.html">Hamiltonian
                        functions</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utility functions</a>
                    </li>
                </ul>


            </div>

        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


        <nav class="wy-nav-top" aria-label="top navigation">

            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="../index.html">pyCCE</a>

        </nav>


        <div class="wy-nav-content">

            <div class="rst-content">


                <div role="navigation" aria-label="breadcrumbs navigation">

                    <ul class="wy-breadcrumbs">

                        <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>

                        <li><a href="../tutorial.html">Tutorials</a> &raquo;</li>

                        <li>VV in SiC</li>


                        <li class="wy-breadcrumbs-aside">


                            <a href="../_sources/tutorials/sic_vv.ipynb.txt" rel="nofollow"> View page source</a>


                        </li>

                    </ul>


                    <hr/>
                </div>
                <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                    <div itemprop="articleBody">


                        <style>
                            /* CSS for nbsphinx extension */

                            /* remove conflicting styling from Sphinx themes */
                            div.nbinput.container div.prompt *,
                            div.nboutput.container div.prompt *,
                            div.nbinput.container div.input_area pre,
                            div.nboutput.container div.output_area pre,
                            div.nbinput.container div.input_area .highlight,
                            div.nboutput.container div.output_area .highlight {
                                border: none;
                                padding: 0;
                                margin: 0;
                                box-shadow: none;
                            }

                            div.nbinput.container > div[class*=highlight],
                            div.nboutput.container > div[class*=highlight] {
                                margin: 0;
                            }

                            div.nbinput.container div.prompt *,
                            div.nboutput.container div.prompt * {
                                background: none;
                            }

                            div.nboutput.container div.output_area .highlight,
                            div.nboutput.container div.output_area pre {
                                background: unset;
                            }

                            div.nboutput.container div.output_area div.highlight {
                                color: unset; /* override Pygments text color */
                            }

                            /* avoid gaps between output lines */
                            div.nboutput.container div[class*=highlight] pre {
                                line-height: normal;
                            }

                            /* input/output containers */
                            div.nbinput.container,
                            div.nboutput.container {
                                display: -webkit-flex;
                                display: flex;
                                align-items: flex-start;
                                margin: 0;
                                width: 100%;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container,
                                div.nboutput.container {
                                    flex-direction: column;
                                }
                            }

                            /* input container */
                            div.nbinput.container {
                                padding-top: 5px;
                            }

                            /* last container */
                            div.nblast.container {
                                padding-bottom: 5px;
                            }

                            /* input prompt */
                            div.nbinput.container div.prompt pre {
                                color: #307FC1;
                            }

                            /* output prompt */
                            div.nboutput.container div.prompt pre {
                                color: #BF5B3D;
                            }

                            /* all prompts */
                            div.nbinput.container div.prompt,
                            div.nboutput.container div.prompt {
                                width: 4.5ex;
                                padding-top: 5px;
                                position: relative;
                                user-select: none;
                            }

                            div.nbinput.container div.prompt > div,
                            div.nboutput.container div.prompt > div {
                                position: absolute;
                                right: 0;
                                margin-right: 0.3ex;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container div.prompt,
                                div.nboutput.container div.prompt {
                                    width: unset;
                                    text-align: left;
                                    padding: 0.4em;
                                }

                                div.nboutput.container div.prompt.empty {
                                    padding: 0;
                                }

                                div.nbinput.container div.prompt > div,
                                div.nboutput.container div.prompt > div {
                                    position: unset;
                                }
                            }

                            /* disable scrollbars on prompts */
                            div.nbinput.container div.prompt pre,
                            div.nboutput.container div.prompt pre {
                                overflow: hidden;
                            }

                            /* input/output area */
                            div.nbinput.container div.input_area,
                            div.nboutput.container div.output_area {
                                -webkit-flex: 1;
                                flex: 1;
                                overflow: auto;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container div.input_area,
                                div.nboutput.container div.output_area {
                                    width: 100%;
                                }
                            }

                            /* input area */
                            div.nbinput.container div.input_area {
                                border: 1px solid #e0e0e0;
                                border-radius: 2px;
                                /*background: #f5f5f5;*/
                            }

                            /* override MathJax center alignment in output cells */
                            div.nboutput.container div[class*=MathJax] {
                                text-align: left !important;
                            }

                            /* override sphinx.ext.imgmath center alignment in output cells */
                            div.nboutput.container div.math p {
                                text-align: left;
                            }

                            /* standard error */
                            div.nboutput.container div.output_area.stderr {
                                background: #fdd;
                            }

                            /* ANSI colors */
                            .ansi-black-fg {
                                color: #3E424D;
                            }

                            .ansi-black-bg {
                                background-color: #3E424D;
                            }

                            .ansi-black-intense-fg {
                                color: #282C36;
                            }

                            .ansi-black-intense-bg {
                                background-color: #282C36;
                            }

                            .ansi-red-fg {
                                color: #E75C58;
                            }

                            .ansi-red-bg {
                                background-color: #E75C58;
                            }

                            .ansi-red-intense-fg {
                                color: #B22B31;
                            }

                            .ansi-red-intense-bg {
                                background-color: #B22B31;
                            }

                            .ansi-green-fg {
                                color: #00A250;
                            }

                            .ansi-green-bg {
                                background-color: #00A250;
                            }

                            .ansi-green-intense-fg {
                                color: #007427;
                            }

                            .ansi-green-intense-bg {
                                background-color: #007427;
                            }

                            .ansi-yellow-fg {
                                color: #DDB62B;
                            }

                            .ansi-yellow-bg {
                                background-color: #DDB62B;
                            }

                            .ansi-yellow-intense-fg {
                                color: #B27D12;
                            }

                            .ansi-yellow-intense-bg {
                                background-color: #B27D12;
                            }

                            .ansi-blue-fg {
                                color: #208FFB;
                            }

                            .ansi-blue-bg {
                                background-color: #208FFB;
                            }

                            .ansi-blue-intense-fg {
                                color: #0065CA;
                            }

                            .ansi-blue-intense-bg {
                                background-color: #0065CA;
                            }

                            .ansi-magenta-fg {
                                color: #D160C4;
                            }

                            .ansi-magenta-bg {
                                background-color: #D160C4;
                            }

                            .ansi-magenta-intense-fg {
                                color: #A03196;
                            }

                            .ansi-magenta-intense-bg {
                                background-color: #A03196;
                            }

                            .ansi-cyan-fg {
                                color: #60C6C8;
                            }

                            .ansi-cyan-bg {
                                background-color: #60C6C8;
                            }

                            .ansi-cyan-intense-fg {
                                color: #258F8F;
                            }

                            .ansi-cyan-intense-bg {
                                background-color: #258F8F;
                            }

                            .ansi-white-fg {
                                color: #C5C1B4;
                            }

                            .ansi-white-bg {
                                background-color: #C5C1B4;
                            }

                            .ansi-white-intense-fg {
                                color: #A1A6B2;
                            }

                            .ansi-white-intense-bg {
                                background-color: #A1A6B2;
                            }

                            .ansi-default-inverse-fg {
                                color: #FFFFFF;
                            }

                            .ansi-default-inverse-bg {
                                background-color: #000000;
                            }

                            .ansi-bold {
                                font-weight: bold;
                            }

                            .ansi-underline {
                                text-decoration: underline;
                            }


                            div.nbinput.container div.input_area div[class*=highlight] > pre,
                            div.nboutput.container div.output_area div[class*=highlight] > pre,
                            div.nboutput.container div.output_area div[class*=highlight].math,
                            div.nboutput.container div.output_area.rendered_html,
                            div.nboutput.container div.output_area > div.output_javascript,
                            div.nboutput.container div.output_area:not(.rendered_html) > img {
                                padding: 5px;
                                margin: 0;
                            }

                            /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
                            div.nbinput.container div.input_area > div[class^='highlight'],
                            div.nboutput.container div.output_area > div[class^='highlight'] {
                                overflow-y: hidden;
                            }

                            /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
                            .prompt a.copybtn {
                                display: none;
                            }

                            /* Some additional styling taken form the Jupyter notebook CSS */
                            div.rendered_html table {
                                border: none;
                                border-collapse: collapse;
                                border-spacing: 0;
                                color: black;
                                font-size: 12px;
                                table-layout: fixed;
                            }

                            div.rendered_html thead {
                                border-bottom: 1px solid black;
                                vertical-align: bottom;
                            }

                            div.rendered_html tr,
                            div.rendered_html th,
                            div.rendered_html td {
                                text-align: right;
                                vertical-align: middle;
                                padding: 0.5em 0.5em;
                                line-height: normal;
                                white-space: normal;
                                max-width: none;
                                border: none;
                            }

                            div.rendered_html th {
                                font-weight: bold;
                            }

                            div.rendered_html tbody tr:nth-child(odd) {
                                background: #f5f5f5;
                            }

                            div.rendered_html tbody tr:hover {
                                background: rgba(66, 165, 245, 0.2);
                            }

                            /* CSS overrides for sphinx_rtd_theme */

                            /* 24px margin */
                            .nbinput.nblast.container,
                            .nboutput.nblast.container {
                                margin-bottom: 19px; /* padding has already 5px */
                            }

                            /* ... except between code cells! */
                            .nblast.container + .nbinput.container {
                                margin-top: -19px;
                            }

                            .admonition > p:before {
                                margin-right: 4px; /* make room for the exclamation icon */
                            }

                            /* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
                            .math {
                                text-align: unset;
                            }
                        </style>
                        <div class="section" id="VV-in-SiC">
                            <h1>VV in SiC<a class="headerlink" href="#VV-in-SiC"
                                            title="Permalink to this headline">¶</a></h1>
                            <p>An example of computing Free Induction Decay (FID) and Hahn-echo (HE) with hyperfine
                                couplings from GIPAW for axial and basal divacancies.</p>
                            <div class="nbinput nblast docutils container">
                                <div class="prompt highlight-none notranslate">
                                    <div class="highlight"><pre><span></span>[1]:
</pre>
                                    </div>
                                </div>
                                <div class="input_area highlight-ipython3 notranslate">
                                    <div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span
                                            class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                                            class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">ase</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span
                                            class="p">(</span><span class="s1">&#39;/home/onizhuk/midway/codes_development/pyCCE&#39;</span><span
                                            class="p">)</span>
<span class="kn">import</span> <span class="nn">pycce</span> <span class="k">as</span> <span class="nn">pc</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span
                                            class="n">suppress</span><span class="o">=</span><span
                                            class="kc">True</span><span class="p">,</span> <span
                                            class="n">precision</span><span class="o">=</span><span
                                            class="mi">5</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span
                                            class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">8805</span>
</pre>
                                    </div>
                                </div>
                            </div>
                            <div class="section" id="Axial-kk-VV">
                                <h2>Axial kk-VV<a class="headerlink" href="#Axial-kk-VV"
                                                  title="Permalink to this headline">¶</a></h2>
                                <p>First we compute FID and HE for axial divacancy.</p>
                                <div class="section" id="Build-BathCell-from-the-ground">
                                    <h3>Build BathCell from the ground<a class="headerlink"
                                                                         href="#Build-BathCell-from-the-ground"
                                                                         title="Permalink to this headline">¶</a></h3>
                                    <p>One can set up <code class="docutils literal notranslate"><span class="pre">BathCell</span></code>
                                        instance providing the parameters of unit cell or proviing <code
                                                class="docutils literal notranslate"><span
                                                class="pre">cell</span></code> argument as 3x3 tensor, where each column
                                        define a, b, c unit cell vectors in cartesian coordinates.</p>
                                    <p>In this tutorial we use the second approach.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[2]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="c1"># Set up unit cell with (a, b, c, alpha, beta, gamma)</span>
<span class="n">sic</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">BathCell</span><span
                                                    class="p">(</span><span class="mf">3.073</span><span
                                                    class="p">,</span> <span class="mf">3.073</span><span
                                                    class="p">,</span> <span class="mf">10.053</span><span
                                                    class="p">,</span> <span class="mi">90</span><span
                                                    class="p">,</span> <span class="mi">90</span><span
                                                    class="p">,</span> <span class="mi">120</span><span
                                                    class="p">,</span> <span class="s1">&#39;deg&#39;</span><span
                                                    class="p">)</span>
<span class="c1"># z axis in cell coordinates</span>
<span class="n">sic</span><span class="o">.</span><span class="n">zdir</span> <span class="o">=</span> <span
                                                    class="p">[</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">]</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Next, user has to define positions of atoms in the unit cell. It is done with
                                        <code class="docutils literal notranslate"><span
                                                class="pre">BathCell.add_atoms</span></code> function. It takes
                                        unlimited number of arguments, each argument is a tuple. First element of the
                                        tuple is the name of the atom, second - list of xyz coordinates either in cell
                                        units (if keyword <code class="docutils literal notranslate"><span class="pre">type='cell'</span></code>,
                                        default value) or in Angstrom (if keyword <code
                                                class="docutils literal notranslate"><span
                                                class="pre">type='angstrom'</span></code>). Returns <code
                                                class="docutils literal notranslate"><span
                                                class="pre">BathCell.atoms</span></code> dictionary, which contains list
                                        of coordinates for each type of elements.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[3]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="c1"># position of atoms</span>
<span class="n">sic</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">((</span><span
                                                    class="s1">&#39;Si&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.1880</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.6880</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.33333333</span><span class="p">,</span> <span
                                                    class="mf">0.66666667</span><span class="p">,</span> <span
                                                    class="mf">0.4380</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.66666667</span><span class="p">,</span> <span
                                                    class="mf">0.33333333</span><span class="p">,</span> <span
                                                    class="mf">0.9380</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.0000</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.00000000</span><span class="p">,</span> <span
                                                    class="mf">0.5000</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.33333333</span><span class="p">,</span> <span
                                                    class="mf">0.66666667</span><span class="p">,</span> <span
                                                    class="mf">0.2500</span><span class="p">]),</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span
                                                    class="p">[</span><span class="mf">0.66666667</span><span class="p">,</span> <span
                                                    class="mf">0.33333333</span><span class="p">,</span> <span
                                                    class="mf">0.7500</span><span class="p">]));</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Two types of isotopes present in SiC: <span class="math notranslate nohighlight">\(^{29}\)</span>Si
                                        and <span class="math notranslate nohighlight">\(^{13}\)</span>C. We add this
                                        information with <code class="docutils literal notranslate"><span class="pre">BathCell.add_isotopes</span></code>
                                        function. The code knows most of the concentrations, so this step is actually
                                        unnecessary. If no isotopes is provided, the natural concentration of common
                                        magnetic isotopes is assumed.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[4]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="c1"># isotopes</span>
<span class="n">sic</span><span class="o">.</span><span class="n">add_isotopes</span><span class="p">((</span><span
                                                    class="s1">&#39;29Si&#39;</span><span class="p">,</span> <span
                                                    class="mf">0.047</span><span class="p">),</span> <span
                                                    class="p">(</span><span class="s1">&#39;13C&#39;</span><span
                                                    class="p">,</span> <span class="mf">0.011</span><span
                                                    class="p">))</span>

<span class="c1"># defect position in cell units</span>
<span class="n">vsi_cell</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
                                                    class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
                                                    class="mf">0.1880</span><span class="p">]</span>
<span class="n">vc_cell</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
                                                    class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">]</span>

<span class="c1"># Generate bath spin positions</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">gen_supercell</span><span
                                                    class="p">(</span><span class="mi">200</span><span
                                                    class="p">,</span> <span class="n">remove</span><span
                                                    class="o">=</span><span class="p">[(</span><span class="s1">&#39;Si&#39;</span><span
                                                    class="p">,</span> <span class="n">vsi_cell</span><span
                                                    class="p">),</span>
                                       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span
                                                    class="p">,</span> <span class="n">vc_cell</span><span
                                                    class="p">)],</span>
                          <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="Read-Quantum-Espresso-output">
                                    <h3>Read Quantum Espresso output<a class="headerlink"
                                                                       href="#Read-Quantum-Espresso-output"
                                                                       title="Permalink to this headline">¶</a></h3>
                                    <p>For reading hyperfine couplings there is a helper function <code
                                            class="docutils literal notranslate"><span class="pre">read_qe</span></code>
                                        in <code class="docutils literal notranslate"><span class="pre">pycce.io</span></code>
                                        module. <code class="docutils literal notranslate"><span
                                                class="pre">read_qe</span></code> takes from 1 to 3 positional
                                        arguments:</p>
                                    <ul class="simple">
                                        <li><p><code class="docutils literal notranslate"><span
                                                class="pre">pwfile</span></code> name of the pw input/output file;</p>
                                        </li>
                                        <li><p><code class="docutils literal notranslate"><span
                                                class="pre">hyperfine</span></code> name of the gipaw output file
                                            containing hyperfine couplings;</p></li>
                                        <li><p><code class="docutils literal notranslate"><span
                                                class="pre">efg</span></code> name of the gipaw output file containing
                                            electric field tensor calculations.</p></li>
                                    </ul>
                                    <p>In the process, <code class="docutils literal notranslate"><span class="pre">read_qe</span></code>
                                        will read the cell matrix in pw file and apply it to the coordinates is
                                        necessary. However, usually we still need to rotate and translate the Quantum
                                        Espresso supercell to allign it with our <code
                                                class="docutils literal notranslate"><span class="pre">BathArray</span></code>.
                                        For that we can provide additional keywords arguments <code
                                                class="docutils literal notranslate"><span
                                                class="pre">center</span></code> and <code
                                                class="docutils literal notranslate"><span
                                                class="pre">rotation_matrix</span></code>. <code
                                                class="docutils literal notranslate"><span
                                                class="pre">center</span></code> is the position of (0, 0, 0) point in
                                        coordinates of pw file, and <code class="docutils literal notranslate"><span
                                                class="pre">rotation_matrix</span></code> is rotation matrix which
                                        aligns z-direction of the GIPAW output. This matrix,
                                        acting on the (0, 0, 1) in Cartesian coordinates of GIPAW output should produce
                                        (a, b, c) vector, alligned with zdirection of the BathCell. Keyword argument
                                        <code class="docutils literal notranslate"><span
                                                class="pre">rm_style</span></code> shows whether <code
                                                class="docutils literal notranslate"><span
                                                class="pre">rotation_matrix</span></code> contains coordinates of new
                                        basis set as rows (<code class="docutils literal notranslate"><span class="pre">'row'</span></code>,
                                        common in physics) or columns (<code class="docutils literal notranslate"><span
                                                class="pre">'col'</span></code>, common in math).</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[5]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="c1"># Prepare rotation matrix to alling with z axis of generated atoms</span>
<span class="c1"># This matrix, acting on the [0, 0, 1] in Cartesian coordinates of GIPAW output</span>
<span class="c1"># Should produce [a, b, c] vector, alligned with zdirection of the BathCell</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                    class="n">array</span><span class="p">([[</span><span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span class="o">-</span><span
                                                    class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span
                                                    class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">]])</span>

<span class="c1"># Position of (0,0,0) point in cell coordinates</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span
                                                    class="p">,</span> <span class="mf">0.5</span><span
                                                    class="p">,</span> <span class="mf">0.5</span><span
                                                    class="p">]</span>
<span class="c1"># Read GIPAW results</span>
<span class="n">exatoms</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span
                                                    class="n">read_qe</span><span class="p">(</span><span class="s1">&#39;axial/pw.in&#39;</span><span
                                                    class="p">,</span>
                     <span class="n">hyperfine</span><span class="o">=</span><span
                                                    class="s1">&#39;axial/gipaw.out&#39;</span><span class="p">,</span>
                     <span class="n">center</span><span class="o">=</span><span class="n">center</span><span
                                                    class="p">,</span> <span class="n">rotation_matrix</span><span
                                                    class="o">=</span><span class="n">M</span><span class="p">,</span>
                     <span class="n">rm_style</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span
                                                    class="p">,</span>
                     <span class="n">isotopes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span
                                                    class="p">:</span><span class="s1">&#39;13C&#39;</span><span
                                                    class="p">,</span> <span class="s1">&#39;Si&#39;</span><span
                                                    class="p">:</span><span class="s1">&#39;29Si&#39;</span><span
                                                    class="p">})</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p><code class="docutils literal notranslate"><span
                                            class="pre">pc.read_qe</span></code> produces instance of <code
                                            class="docutils literal notranslate"><span
                                            class="pre">BathArray</span></code>, with names of bath spins as the most
                                        common isotopes of the following elements (if keyword <code
                                                class="docutils literal notranslate"><span
                                                class="pre">isotopes</span></code> set to <code
                                                class="docutils literal notranslate"><span
                                                class="pre">None</span></code>) or from the mapping provided by the
                                        <code class="docutils literal notranslate"><span
                                                class="pre">isotopes</span></code> argument.</p>
                                </div>
                                <div class="section" id="Set-up-CCE-Simulator">
                                    <h3>Set up CCE Simulator<a class="headerlink" href="#Set-up-CCE-Simulator"
                                                               title="Permalink to this headline">¶</a></h3>
                                    <p>In this example we set up bare <code class="docutils literal notranslate"><span
                                            class="pre">Simulator</span></code> and add properties of the spin bath
                                        later.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[6]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="c1"># Setting up CCE calculations</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">to_cartesian</span><span
                                                    class="p">(</span><span class="n">vsi_cell</span><span
                                                    class="p">)</span>
<span class="n">CCE_order</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">r_bath</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">r_dipole</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                    class="n">array</span><span class="p">([</span><span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">500</span><span class="p">])</span>

<span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Simulator</span><span
                                                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">pos</span><span class="p">,</span> <span
                                                    class="n">alpha</span><span class="o">=</span><span
                                                    class="p">[</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">],</span> <span
                                                    class="n">beta</span><span class="o">=</span><span
                                                    class="p">[</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">],</span> <span class="n">magnetic_field</span><span
                                                    class="o">=</span><span class="n">B</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Function <code class="docutils literal notranslate"><span class="pre">Simulator.read_bath</span></code>
                                        can be called explicitly to initiallize spin bath. Additional keyword argument
                                        <code class="docutils literal notranslate"><span
                                                class="pre">external_bath</span></code> takes instance of <code
                                                class="docutils literal notranslate"><span class="pre">BathArray</span></code>
                                        with hyperfine couplings read from Quantum Espresso. The program then finds the
                                        spins with the same name at the same positions (within the range defined by
                                        <code class="docutils literal notranslate"><span class="pre">error_range</span></code>
                                        keyword argument) in the total bath and sets their hyperfine couplings.</p>
                                    <p>Finally, we call <code class="docutils literal notranslate"><span class="pre">Simulator.generate_clusters</span></code>
                                        to find the bath spin clusters in the provided bath.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[7]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">calc</span><span class="o">.</span><span class="n">read_bath</span><span class="p">(</span><span
                                                    class="n">atoms</span><span class="p">,</span> <span class="n">r_bath</span><span
                                                    class="p">,</span> <span class="n">external_bath</span><span
                                                    class="o">=</span><span class="n">exatoms</span><span
                                                    class="p">);</span>
<span class="n">calc</span><span class="o">.</span><span class="n">generate_clusters</span><span class="p">(</span><span
                                                    class="n">CCE_order</span><span class="p">,</span> <span class="n">r_dipole</span><span
                                                    class="o">=</span><span class="n">r_dipole</span><span
                                                    class="p">);</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="FID-with-DFT-hyperfines">
                                    <h3>FID with DFT hyperfines<a class="headerlink" href="#FID-with-DFT-hyperfines"
                                                                  title="Permalink to this headline">¶</a></h3>
                                    <p>We provide <code class="docutils literal notranslate"><span
                                            class="pre">pulses</span></code> argument directly to the compute function
                                        instead of during initiallization of the <code
                                                class="docutils literal notranslate"><span class="pre">Simulator</span></code>
                                        object.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[8]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">time_space</span> <span class="o">=</span> <span class="n">np</span><span
                                                    class="o">.</span><span class="n">linspace</span><span
                                                    class="p">(</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mf">0.01</span><span class="p">,</span> <span
                                                    class="mi">501</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">ldft</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">cce_coherence</span><span
                                                    class="p">(</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">pulses</span><span
                                                    class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">as_delay</span><span
                                                    class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="FID-with-hyperfines-from-point-dipole-approximation">
                                    <h3>FID with hyperfines from point dipole approximation<a class="headerlink"
                                                                                              href="#FID-with-hyperfines-from-point-dipole-approximation"
                                                                                              title="Permalink to this headline">¶</a>
                                    </h3>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[9]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">pdcalc</span> <span class="o">=</span> <span class="n">pc</span><span
                                                    class="o">.</span><span class="n">Simulator</span><span
                                                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">pos</span><span class="p">,</span> <span
                                                    class="n">alpha</span><span class="o">=</span><span
                                                    class="p">[</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">],</span> <span
                                                    class="n">beta</span><span class="o">=</span><span
                                                    class="p">[</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">],</span> <span class="n">magnetic_field</span><span
                                                    class="o">=</span><span class="n">B</span><span class="p">,</span>
                      <span class="n">bath</span><span class="o">=</span><span class="n">atoms</span><span
                                                    class="p">,</span> <span class="n">r_bath</span><span
                                                    class="o">=</span><span class="n">r_bath</span><span
                                                    class="p">,</span> <span class="n">order</span><span
                                                    class="o">=</span><span class="n">CCE_order</span><span
                                                    class="p">,</span> <span class="n">r_dipole</span><span
                                                    class="o">=</span><span class="n">r_dipole</span><span
                                                    class="p">)</span>
<span class="n">lpd</span> <span class="o">=</span> <span class="n">pdcalc</span><span class="o">.</span><span
                                                    class="n">cce_coherence</span><span class="p">(</span><span
                                                    class="n">time_space</span><span class="p">,</span> <span class="n">pulses</span><span
                                                    class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">as_delay</span><span
                                                    class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Plot the results and and see that the predictions are significantly
                                        different.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[10]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                    class="n">time_space</span><span class="p">,</span> <span class="n">lpd</span><span
                                                    class="o">.</span><span class="n">real</span><span
                                                    class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span
                                                    class="s1">&#39;point dipole&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">ldft</span><span
                                                    class="o">.</span><span class="n">real</span><span
                                                    class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span class="s1">&#39;DFT&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[10]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
Text(0, 0.5, &#39;L&#39;)
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <img alt="../_images/tutorials_sic_vv_21_1.png"
                                                 src="../_images/tutorials_sic_vv_21_1.png"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="Hahn-echo-comparison">
                                    <h3>Hahn-echo comparison<a class="headerlink" href="#Hahn-echo-comparison"
                                                               title="Permalink to this headline">¶</a></h3>
                                    <p>Now we compare the predictions for Hahn-echo signal with different
                                        hyperfines.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[11]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">he_time</span> <span class="o">=</span> <span class="n">np</span><span
                                                    class="o">.</span><span class="n">linspace</span><span
                                                    class="p">(</span><span class="mi">0</span><span class="p">,</span> <span
                                                    class="mf">2.5</span><span class="p">,</span> <span
                                                    class="mi">501</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                    class="n">array</span><span class="p">([</span><span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">500</span><span class="p">])</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">he_ldft</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                    class="n">cce_coherence</span><span class="p">(</span><span
                                                    class="n">he_time</span><span class="p">,</span> <span class="n">magnetic_field</span><span
                                                    class="o">=</span><span class="n">B</span><span
                                                    class="p">,</span> <span class="n">pulses</span><span
                                                    class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">as_delay</span><span
                                                    class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>
<span class="n">he_lpd</span> <span class="o">=</span> <span class="n">pdcalc</span><span class="o">.</span><span
                                                    class="n">cce_coherence</span><span class="p">(</span><span
                                                    class="n">he_time</span><span class="p">,</span> <span class="n">magnetic_field</span><span
                                                    class="o">=</span><span class="n">B</span><span
                                                    class="p">,</span> <span class="n">pulses</span><span
                                                    class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">as_delay</span><span
                                                    class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Plot the results and compare. We observe that electron spin echo modulations
                                        differ significantly, while the observed decay is about the same.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[12]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                    class="n">he_time</span><span class="p">,</span> <span class="n">he_ldft</span><span
                                                    class="o">.</span><span class="n">real</span><span
                                                    class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span class="s1">&#39;DFT&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">he_time</span><span
                                                    class="p">,</span> <span class="n">he_lpd</span><span
                                                    class="o">.</span><span class="n">real</span><span
                                                    class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span
                                                    class="s1">&#39;point dipole&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[12]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
Text(0, 0.5, &#39;L&#39;)
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <img alt="../_images/tutorials_sic_vv_25_1.png"
                                                 src="../_images/tutorials_sic_vv_25_1.png"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="section" id="Basal-kh-VV-in-SiC">
                                <h2>Basal kh-VV in SiC<a class="headerlink" href="#Basal-kh-VV-in-SiC"
                                                         title="Permalink to this headline">¶</a></h2>
                                <p>Basal divacancy’s Hamiltonian includes both D and E terms, which allows for mixing
                                    between +1 and -1 spin levels at zero field.</p>
                                <p>Thus, either the generalized CCE should be used, or additional perturbational
                                    Hamiltonian terms are to be added. Here we involve the generalized CCE
                                    framework.</p>
                                <p>First, prepare rotation matrix for DFT results. The same supercell was used to
                                    compute hyperfine couplings, however z-axis of the electron spin qubit is aligned
                                    with Si-C bond, therefore we will need to rotate DFT supercell accordingly.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[13]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="c1"># Coordinates of vacancies in cell coordinates (note that Vsi is not located in the first unitcell)</span>
<span class="n">vsi_cell</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span
                                                class="o">.</span><span class="n">array</span><span
                                                class="p">([</span><span class="mi">1</span> <span
                                                class="o">/</span> <span class="mi">3</span><span
                                                class="p">,</span> <span class="mi">2</span> <span
                                                class="o">/</span> <span class="mi">3</span><span
                                                class="p">,</span> <span class="mf">0.0620</span><span
                                                class="p">])</span>
<span class="n">vc_cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">array</span><span class="p">([</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">sic</span><span class="o">.</span><span class="n">zdir</span> <span class="o">=</span> <span
                                                class="p">[</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Rotation matrix for DFT supercell</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">rotmatrix</span><span
                                                class="p">([</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">1</span><span
                                                class="p">],</span> <span class="n">sic</span><span
                                                class="o">.</span><span class="n">to_cartesian</span><span
                                                class="p">(</span><span class="n">vsi_cell</span> <span
                                                class="o">-</span> <span class="n">vc_cell</span><span
                                                class="p">))</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>Total spin bath can be initiallized by simply setting z direction of the <code
                                        class="docutils literal notranslate"><span class="pre">BathCell</span></code>
                                    object.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[14]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">sic</span><span class="o">.</span><span class="n">zdir</span> <span
                                                class="o">=</span> <span class="n">vsi_cell</span> <span
                                                class="o">-</span> <span class="n">vc_cell</span>

<span class="c1"># Generate bath spin positions</span>
<span class="n">sic</span><span class="o">.</span><span class="n">add_isotopes</span><span class="p">((</span><span
                                                class="s1">&#39;29Si&#39;</span><span class="p">,</span> <span
                                                class="mf">0.047</span><span class="p">),</span> <span
                                                class="p">(</span><span class="s1">&#39;13C&#39;</span><span
                                                class="p">,</span> <span class="mf">0.011</span><span
                                                class="p">))</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">gen_supercell</span><span
                                                class="p">(</span><span class="mi">200</span><span
                                                class="p">,</span> <span class="n">remove</span><span class="o">=</span><span
                                                class="p">[(</span><span class="s1">&#39;Si&#39;</span><span
                                                class="p">,</span> <span class="n">vsi_cell</span><span
                                                class="p">),</span>
                                       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span
                                                class="p">,</span> <span class="n">vc_cell</span><span
                                                class="p">)],</span>
                          <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>Read DFT results with <code class="docutils literal notranslate"><span class="pre">read_qe</span></code>
                                    function. To rotate in the correct frame we need to apply both changes of basis
                                    consequently</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[15]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">array</span><span class="p">([[</span><span
                                                class="mi">0</span><span class="p">,</span> <span
                                                class="mi">0</span><span class="p">,</span> <span
                                                class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span
                                                class="mi">1</span><span class="p">,</span> <span
                                                class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span
                                                class="mi">0</span><span class="p">,</span> <span
                                                class="mi">0</span><span class="p">]])</span>

<span class="c1"># Position of (0,0,0) point in cell coordinates</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span
                                                class="p">([</span><span class="mf">0.59401</span><span
                                                class="p">,</span> <span class="mf">0.50000</span><span
                                                class="p">,</span> <span class="mf">0.50000</span><span
                                                class="p">])</span>

<span class="c1"># Read GIPAW results</span>
<span class="n">exatoms</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span
                                                class="n">read_qe</span><span class="p">(</span><span class="s1">&#39;basal/pw.in&#39;</span><span
                                                class="p">,</span>
                     <span class="n">hyperfine</span><span class="o">=</span><span
                                                class="s1">&#39;basal/gipaw.out&#39;</span><span class="p">,</span>
                     <span class="n">center</span><span class="o">=</span><span class="n">center</span><span
                                                class="p">,</span> <span class="n">rotation_matrix</span><span
                                                class="o">=</span><span class="p">(</span><span class="n">M</span><span
                                                class="o">.</span><span class="n">T</span> <span
                                                class="o">@</span> <span class="n">R</span><span class="p">),</span>
                     <span class="n">rm_style</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span
                                                class="p">,</span>
                     <span class="n">isotopes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C&#39;</span><span
                                                class="p">:</span><span class="s1">&#39;13C&#39;</span><span
                                                class="p">,</span> <span class="s1">&#39;Si&#39;</span><span
                                                class="p">:</span><span class="s1">&#39;29Si&#39;</span><span class="p">})</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>To check whether our rotations produced correct results we can find the indexes of
                                    the <code class="docutils literal notranslate"><span
                                            class="pre">BathArray</span></code> and DFT output with <code
                                            class="docutils literal notranslate"><span
                                            class="pre">pc.same_bath_indexes</span></code> function. It returns a tuple,
                                    containing the indexes of elements in the two <code
                                            class="docutils literal notranslate"><span
                                            class="pre">BathArray</span></code> instances with the same position and
                                    name. First element of the tuple - indexes of first argument, second - of the
                                    second. For that we generate supecell with <code
                                            class="docutils literal notranslate"><span
                                            class="pre">BathCell</span></code> class, containing 100% isotopes, and
                                    count the number of found indexes - iut should be equal
                                    to the size of DFT supercell.</p>
                                <div class="nbinput docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[30]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="c1"># isotopes</span>
<span class="n">sic</span><span class="o">.</span><span class="n">add_isotopes</span><span class="p">((</span><span
                                                class="s1">&#39;29Si&#39;</span><span class="p">,</span> <span
                                                class="mi">1</span><span class="p">),</span> <span
                                                class="p">(</span><span class="s1">&#39;13C&#39;</span><span
                                                class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">allcell</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span
                                                class="n">gen_supercell</span><span class="p">(</span><span class="mi">50</span><span
                                                class="p">,</span> <span class="n">remove</span><span class="o">=</span><span
                                                class="p">[(</span><span class="s1">&#39;Si&#39;</span><span
                                                class="p">,</span> <span class="n">vsi_cell</span><span
                                                class="p">),</span>
                                       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span
                                                class="p">,</span> <span class="n">vc_cell</span><span
                                                class="p">)],</span>
                            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span
                                                class="p">)</span>

<span class="n">indexes</span><span class="p">,</span> <span class="n">ext_indexes</span> <span class="o">=</span> <span
                                                class="n">pc</span><span class="o">.</span><span class="n">same_bath_indexes</span><span
                                                class="p">(</span><span class="n">allcell</span><span class="p">,</span> <span
                                                class="n">exatoms</span><span class="p">,</span> <span
                                                class="mf">0.2</span><span class="p">,</span> <span
                                                class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span
                                                class="s2">&quot;There are </span><span class="si">{</span><span
                                                class="n">indexes</span><span class="o">.</span><span
                                                class="n">size</span><span class="si">}</span><span class="s2"> same elements.&quot;</span>
      <span class="sa">f</span><span class="s2">&quot; Size of the DFT supercell is </span><span
                                                class="si">{</span><span class="n">exatoms</span><span
                                                class="o">.</span><span class="n">size</span><span
                                                class="si">}</span><span class="s2">&quot;</span><span
                                                class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput nblast docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight"><pre>
There are 1438 same elements. Size of the DFT supercell is 1438
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="Setting-up-calculations">
                                    <h3>Setting up calculations<a class="headerlink" href="#Setting-up-calculations"
                                                                  title="Permalink to this headline">¶</a></h3>
                                    <p>Now we can safely setup calculations. We will compare results with or without
                                        bath state sampling.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[17]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">1.334</span> <span
                                                    class="o">*</span> <span class="mf">1e6</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">0.0184</span> <span class="o">*</span> <span
                                                    class="mf">1e6</span>
<span class="n">magnetic_field</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Simulator</span><span
                                                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">pos</span><span class="p">,</span> <span
                                                    class="n">bath</span><span class="o">=</span><span
                                                    class="n">atoms</span><span class="p">,</span> <span class="n">external_bath</span><span
                                                    class="o">=</span><span class="n">exatoms</span><span
                                                    class="p">,</span> <span class="n">D</span><span
                                                    class="o">=</span><span class="n">D</span><span
                                                    class="p">,</span> <span class="n">E</span><span
                                                    class="o">=</span><span class="n">E</span><span class="p">,</span>
                    <span class="n">magnetic_field</span><span class="o">=</span><span
                                                    class="n">magnetic_field</span><span class="p">,</span>
                    <span class="n">r_bath</span><span class="o">=</span><span class="n">r_bath</span><span
                                                    class="p">,</span> <span class="n">order</span><span
                                                    class="o">=</span><span class="n">CCE_order</span><span
                                                    class="p">,</span> <span class="n">r_dipole</span><span
                                                    class="o">=</span><span class="n">r_dipole</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>The code automatically picks up the two lowest eigenstates of the central spin
                                        hamiltonian, defined by <code class="docutils literal notranslate"><span
                                                class="pre">Simulator.magnetic_field</span></code>, <code
                                                class="docutils literal notranslate"><span
                                                class="pre">Simulator.gyro</span></code>, <code
                                                class="docutils literal notranslate"><span
                                                class="pre">Simulator.zfs</span></code>, as qubi</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[18]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
Simulator for spin-1.
alpha: [ 0.+0.j -1.+0.j  0.+0.j]
beta: [-0.70711-0.j  0.     +0.j  0.70711+0.j]
gyromagnetic ratio: -17608.59705 kHz * rad / G
zero field splitting:
array([[-426266.66667,       0.     ,       0.     ],
       [      0.     , -463066.66667,       0.     ],
       [      0.     ,       0.     ,  889333.33333]])
magnetic field:
array([0., 0., 0.])

Parameters of cluster expansion:
r_bath: 40
r_dipole: 8
order: 2

Bath consists of 761 spins.

Clusters include:
761  clusters of order 1.
1870  clusters of order 2.

</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>We can use <code class="docutils literal notranslate"><span class="pre">Simulator.eigenstates</span></code>
                                        function to generate qubit states</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[19]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">calc</span><span class="o">.</span><span class="n">eigenstates</span><span
                                                    class="p">(</span><span class="n">D</span><span
                                                    class="o">=</span><span class="n">D</span><span
                                                    class="p">,</span> <span class="n">E</span><span
                                                    class="o">=</span><span class="n">E</span><span
                                                    class="p">,</span> <span class="n">alpha</span><span
                                                    class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">beta</span><span class="o">=</span><span
                                                    class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span
                                                    class="s1">&#39;0 state: </span><span class="si">{</span><span
                                                    class="n">calc</span><span class="o">.</span><span
                                                    class="n">alpha</span><span class="si">}</span><span class="s1">; 1 state: </span><span
                                                    class="si">{</span><span class="n">calc</span><span
                                                    class="o">.</span><span class="n">beta</span><span
                                                    class="si">}</span><span class="s1">&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
0 state: [-0.70711+0.j  0.     +0.j -0.70711+0.j]; 1 state: [ 0.+0.j -1.+0.j  0.+0.j]
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="FID-Decay">
                                    <h3>FID Decay<a class="headerlink" href="#FID-Decay"
                                                    title="Permalink to this headline">¶</a></h3>
                                    <p>Now, use generalized CCE to compute FID decay of the coherence function at
                                        different CCE orders</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[20]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Number of pulses</span>
<span class="n">time_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                    class="n">linspace</span><span class="p">(</span><span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">101</span><span class="p">)</span> <span class="c1"># Time points at which to compute</span>

<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">2</span><span class="p">,</span> <span
                                                    class="mi">3</span><span class="p">]</span>
<span class="n">lgen</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">r_bath</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">r_dipole</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Simulator</span><span
                                                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">pos</span><span class="p">,</span> <span
                                                    class="n">bath</span><span class="o">=</span><span
                                                    class="n">atoms</span><span class="p">,</span> <span class="n">external_bath</span><span
                                                    class="o">=</span><span class="n">exatoms</span><span
                                                    class="p">,</span>
                    <span class="n">D</span><span class="o">=</span><span class="n">D</span><span
                                                    class="p">,</span> <span class="n">E</span><span
                                                    class="o">=</span><span class="n">E</span><span
                                                    class="p">,</span> <span class="n">pulses</span><span
                                                    class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">alpha</span><span
                                                    class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">beta</span><span class="o">=</span><span
                                                    class="mi">0</span><span class="p">,</span>
                    <span class="n">r_bath</span><span class="o">=</span><span class="n">r_bath</span><span
                                                    class="p">,</span> <span class="n">r_dipole</span><span
                                                    class="o">=</span><span class="n">r_dipole</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[21]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span
                                                    class="n">orders</span><span class="p">:</span>
    <span class="n">calc</span><span class="o">.</span><span class="n">generate_clusters</span><span
                                                    class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                    class="n">compute</span><span class="p">(</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">method</span><span
                                                    class="o">=</span><span class="s1">&#39;gcce&#39;</span><span
                                                    class="p">,</span> <span class="n">mean_field</span><span class="o">=</span><span
                                                    class="kc">False</span><span class="p">,</span>
                     <span class="n">quantity</span><span class="o">=</span><span
                                                    class="s1">&#39;coherence&#39;</span><span class="p">,</span> <span
                                                    class="n">as_delay</span><span class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>

    <span class="n">lgen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                                    class="n">np</span><span class="o">.</span><span
                                                    class="n">abs</span><span class="p">(</span><span class="n">l</span><span
                                                    class="p">))</span>

<span class="n">lgen</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span
                                                    class="p">(</span><span class="n">lgen</span><span
                                                    class="p">,</span> <span class="n">columns</span><span
                                                    class="o">=</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">index</span><span
                                                    class="o">=</span><span class="n">orders</span><span
                                                    class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>We see that the results do not converge, but rather start to diverge. Bath
                                        sampling (setting <code class="docutils literal notranslate"><span class="pre">mean_field=True</span></code>)
                                        will help with that.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[22]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">lgen</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span
                                                    class="o">-</span><span class="mf">0.1</span><span
                                                    class="p">,</span><span class="mf">1.1</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[22]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
(-0.1, 1.1)
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <img alt="../_images/tutorials_sic_vv_44_1.png"
                                                 src="../_images/tutorials_sic_vv_44_1.png"/>
                                        </div>
                                    </div>
                                    <p>Note, that this approach is nbstates times more expensive than gCCE, therefore
                                        the following calculation will take a couple of minutes.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[23]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span
                                                    class="mi">1</span><span class="p">,</span> <span
                                                    class="mi">2</span><span class="p">,</span> <span
                                                    class="mi">3</span><span class="p">]</span>
<span class="n">lgcce</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">r_bath</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">r_dipole</span> <span class="o">=</span> <span class="mi">6</span>

<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">orders</span><span
                                                    class="p">:</span>
    <span class="n">calc</span><span class="o">.</span><span class="n">generate_clusters</span><span
                                                    class="p">(</span><span class="n">o</span><span class="p">)</span>

    <span class="n">l</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                    class="n">compute</span><span class="p">(</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">nbstates</span><span
                                                    class="o">=</span><span class="mi">30</span><span class="p">,</span> <span
                                                    class="n">seed</span><span class="o">=</span><span
                                                    class="n">seed</span><span class="p">,</span>
                     <span class="n">mean_field</span><span class="o">=</span><span class="kc">True</span><span
                                                    class="p">,</span> <span class="n">method</span><span
                                                    class="o">=</span><span class="s1">&#39;gcce&#39;</span><span
                                                    class="p">,</span>
                     <span class="n">quantity</span><span class="o">=</span><span
                                                    class="s1">&#39;coherence&#39;</span><span class="p">,</span> <span
                                                    class="n">as_delay</span><span class="o">=</span><span class="kc">False</span><span
                                                    class="p">)</span>

    <span class="n">lgcce</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span
                                                    class="n">np</span><span class="o">.</span><span
                                                    class="n">abs</span><span class="p">(</span><span class="n">l</span><span
                                                    class="p">))</span>

<span class="n">lgcce</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span
                                                    class="p">(</span><span class="n">lgcce</span><span
                                                    class="p">,</span> <span class="n">columns</span><span
                                                    class="o">=</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">index</span><span
                                                    class="o">=</span><span class="n">orders</span><span
                                                    class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="Compare-the-two-results">
                                    <h3>Compare the two results<a class="headerlink" href="#Compare-the-two-results"
                                                                  title="Permalink to this headline">¶</a></h3>
                                    <p>The gCCE results are converged at 1st order. Note that we used only a small
                                        number of bath states (30), thus the calculations are not converged with respect
                                        to number of bath states. Calculations with higher number of bath states (~100)
                                        will produce correct results.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[24]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                    class="n">lgen</span><span class="p">,</span> <span
                                                    class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span
                                                    class="p">,</span> <span class="n">ls</span><span class="o">=</span><span
                                                    class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lgcce</span><span
                                                    class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span
                                                    class="o">-</span><span class="mf">0.1</span><span
                                                    class="p">,</span><span class="mf">1.1</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[24]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
(-0.1, 1.1)
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <img alt="../_images/tutorials_sic_vv_48_1.png"
                                                 src="../_images/tutorials_sic_vv_48_1.png"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="section" id="Hahn-echo-decay">
                                    <h3>Hahn-echo decay<a class="headerlink" href="#Hahn-echo-decay"
                                                          title="Permalink to this headline">¶</a></h3>
                                    <p>Using similar procedure, compute the Hahn-echo decay.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[25]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">r_bath</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">r_dipole</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Number of pulses</span>

<span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Simulator</span><span
                                                    class="p">(</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">pos</span><span class="p">,</span> <span
                                                    class="n">bath</span><span class="o">=</span><span
                                                    class="n">atoms</span><span class="p">,</span> <span class="n">external_bath</span><span
                                                    class="o">=</span><span class="n">exatoms</span><span
                                                    class="p">,</span>
                    <span class="n">pulses</span><span class="o">=</span><span class="n">N</span><span
                                                    class="p">,</span> <span class="n">D</span><span
                                                    class="o">=</span><span class="n">D</span><span
                                                    class="p">,</span> <span class="n">E</span><span
                                                    class="o">=</span><span class="n">E</span><span
                                                    class="p">,</span> <span class="n">alpha</span><span
                                                    class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span
                                                    class="n">beta</span><span class="o">=</span><span
                                                    class="mi">0</span><span class="p">,</span>
                    <span class="n">r_bath</span><span class="o">=</span><span class="n">r_bath</span><span
                                                    class="p">,</span> <span class="n">order</span><span
                                                    class="o">=</span><span class="n">order</span><span
                                                    class="p">,</span> <span class="n">r_dipole</span><span
                                                    class="o">=</span><span class="n">r_dipole</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[26]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                    class="n">linspace</span><span class="p">(</span><span
                                                    class="mi">0</span><span class="p">,</span> <span
                                                    class="mi">4</span><span class="p">,</span> <span
                                                    class="mi">101</span><span class="p">)</span> <span class="c1"># time points (in ms)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[27]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">helgen</span> <span class="o">=</span> <span class="n">calc</span><span
                                                    class="o">.</span><span class="n">compute</span><span
                                                    class="p">(</span><span class="n">ts</span><span class="p">,</span> <span
                                                    class="n">mean_field</span><span class="o">=</span><span class="kc">False</span><span
                                                    class="p">,</span>
                      <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gcce&#39;</span><span
                                                    class="p">,</span> <span class="n">quantity</span><span
                                                    class="o">=</span><span class="s1">&#39;coherence&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <p>Note the number of nbstates leads to significantly increased time of the
                                        calculation. The interface to mpi implementation is provided with keyword <code
                                                class="docutils literal notranslate"><span
                                                class="pre">parallel_states</span></code>. However it requires <code
                                                class="docutils literal notranslate"><span
                                                class="pre">mpi4py</span></code> installed and a run on several cores.
                                    </p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[28]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">helgcce</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                    class="n">compute</span><span class="p">(</span><span class="n">time_space</span><span
                                                    class="p">,</span> <span class="n">nbstates</span><span
                                                    class="o">=</span><span class="mi">30</span><span class="p">,</span> <span
                                                    class="n">seed</span><span class="o">=</span><span
                                                    class="n">seed</span><span class="p">,</span>
                       <span class="n">mean_field</span><span class="o">=</span><span class="kc">True</span><span
                                                    class="p">,</span>
                       <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gcce&#39;</span><span
                                                    class="p">,</span> <span class="n">quantity</span><span
                                                    class="o">=</span><span class="s1">&#39;coherence&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[29]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                    class="n">ts</span><span class="p">,</span> <span
                                                    class="n">helgcce</span><span class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span
                                                    class="s1">&#39;gCCE with mean field&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                    class="n">ts</span><span class="p">,</span> <span
                                                    class="n">helgen</span><span class="p">,</span> <span class="n">label</span><span
                                                    class="o">=</span><span class="s1">&#39;gCCE&#39;</span><span
                                                    class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span
                                                    class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span
                                                    class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight"><pre><span></span>[29]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight"><pre>
Text(0, 0.5, &#39;L&#39;)
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <img alt="../_images/tutorials_sic_vv_55_1.png"
                                                 src="../_images/tutorials_sic_vv_55_1.png"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>

                </div>
                <footer>
                    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
                        <a href="si_shallow.html" class="btn btn-neutral float-right" title="Shallow donor in Si"
                           accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"
                                                               aria-hidden="true"></span></a>
                        <a href="diamond_nv.html" class="btn btn-neutral float-left" title="NV Center in Diamond"
                           accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span>
                            Previous</a>
                    </div>

                    <hr/>

                    <div role="contentinfo">
                        <p>
                            &#169; Copyright 2021, Mykyta Onizhuk et al.

                        </p>
                    </div>


                    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a

                    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>

                    provided by <a href="https://readthedocs.org">Read the Docs</a>.

                </footer>
            </div>
        </div>

    </section>

</div>


<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
    });
</script>


</body>
</html>