<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
    <meta charset="utf-8"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>Shallow donor in Si &mdash; pyCCE 0.5.1 documentation</title>


    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css"/>


    <link rel="shortcut icon" href="../_static/favicon.png"/>


    <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
    <![endif]-->


    <script type="text/javascript" id="documentation_options" data-url_root="../"
            src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
            src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="../_static/mathjax/tex-chtml.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})
    </script>

    <script type="text/javascript" src="../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../genindex.html"/>
    <link rel="search" title="Search" href="../search.html"/>
    <link rel="next" title="Correlation function" href="classical_noise.html"/>
    <link rel="prev" title="VV in SiC" href="sic_vv.html"/>
</head>

<body class="wy-body-for-nav">


<div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">


                <a href="../index.html">


                    <img src="../_static/logo_white.svg" class="logo" alt="Logo"/>

                </a>


                <div role="search">
                    <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                        <input type="text" name="q" placeholder="Search docs"/>
                        <input type="hidden" name="check_keywords" value="yes"/>
                        <input type="hidden" name="area" value="default"/>
                    </form>
                </div>


            </div>


            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">


                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../theory.html">Theoretical
                        Background</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
                    <li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorials</a>
                        <ul class="current">
                            <li class="toctree-l2"><a class="reference internal" href="diamond_nv.html">NV Center in
                                Diamond</a></li>
                            <li class="toctree-l2"><a class="reference internal" href="sic_vv.html">VV in SiC</a></li>
                            <li class="toctree-l2 current"><a class="current reference internal" href="#">Shallow donor
                                in Si</a>
                                <ul>
                                    <li class="toctree-l3"><a class="reference internal"
                                                              href="#Calculations-with-point-dipole-hyperfines">Calculations
                                        with point dipole hyperfines</a></li>
                                    <li class="toctree-l3"><a class="reference internal"
                                                              href="#Hyperfines-of-the-shallow-donor">Hyperfines of the
                                        shallow donor</a></li>
                                    <li class="toctree-l3"><a class="reference internal" href="#Compare-the-results">Compare
                                        the results</a></li>
                                </ul>
                            </li>
                            <li class="toctree-l2"><a class="reference internal" href="classical_noise.html">Correlation
                                function</a></li>
                        </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">User Manual</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../bath.html">Generating the Spin
                        bath</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../simulator.html">Running the
                        simulations</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../parameters.html">Hamiltonian
                        parameters input</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../dft.html">Interfacing with DFT
                        output</a></li>
                </ul>
                <p class="caption"><span class="caption-text">Additional Documentation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../calculators.html">CCE Calculators</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../hamiltonian.html">Hamiltonian
                        functions</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="../utilities.html">Utility functions</a>
                    </li>
                </ul>


            </div>

        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


        <nav class="wy-nav-top" aria-label="top navigation">

            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="../index.html">pyCCE</a>

        </nav>


        <div class="wy-nav-content">

            <div class="rst-content">


                <div role="navigation" aria-label="breadcrumbs navigation">

                    <ul class="wy-breadcrumbs">

                        <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>

                        <li><a href="../tutorial.html">Tutorials</a> &raquo;</li>

                        <li>Shallow donor in Si</li>


                        <li class="wy-breadcrumbs-aside">


                            <a href="../_sources/tutorials/si_shallow.ipynb.txt" rel="nofollow"> View page source</a>


                        </li>

                    </ul>


                    <hr/>
                </div>
                <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                    <div itemprop="articleBody">


                        <style>
                            /* CSS for nbsphinx extension */

                            /* remove conflicting styling from Sphinx themes */
                            div.nbinput.container div.prompt *,
                            div.nboutput.container div.prompt *,
                            div.nbinput.container div.input_area pre,
                            div.nboutput.container div.output_area pre,
                            div.nbinput.container div.input_area .highlight,
                            div.nboutput.container div.output_area .highlight {
                                border: none;
                                padding: 0;
                                margin: 0;
                                box-shadow: none;
                            }

                            div.nbinput.container > div[class*=highlight],
                            div.nboutput.container > div[class*=highlight] {
                                margin: 0;
                            }

                            div.nbinput.container div.prompt *,
                            div.nboutput.container div.prompt * {
                                background: none;
                            }

                            div.nboutput.container div.output_area .highlight,
                            div.nboutput.container div.output_area pre {
                                background: unset;
                            }

                            div.nboutput.container div.output_area div.highlight {
                                color: unset; /* override Pygments text color */
                            }

                            /* avoid gaps between output lines */
                            div.nboutput.container div[class*=highlight] pre {
                                line-height: normal;
                            }

                            /* input/output containers */
                            div.nbinput.container,
                            div.nboutput.container {
                                display: -webkit-flex;
                                display: flex;
                                align-items: flex-start;
                                margin: 0;
                                width: 100%;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container,
                                div.nboutput.container {
                                    flex-direction: column;
                                }
                            }

                            /* input container */
                            div.nbinput.container {
                                padding-top: 5px;
                            }

                            /* last container */
                            div.nblast.container {
                                padding-bottom: 5px;
                            }

                            /* input prompt */
                            div.nbinput.container div.prompt pre {
                                color: #307FC1;
                            }

                            /* output prompt */
                            div.nboutput.container div.prompt pre {
                                color: #BF5B3D;
                            }

                            /* all prompts */
                            div.nbinput.container div.prompt,
                            div.nboutput.container div.prompt {
                                width: 4.5ex;
                                padding-top: 5px;
                                position: relative;
                                user-select: none;
                            }

                            div.nbinput.container div.prompt > div,
                            div.nboutput.container div.prompt > div {
                                position: absolute;
                                right: 0;
                                margin-right: 0.3ex;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container div.prompt,
                                div.nboutput.container div.prompt {
                                    width: unset;
                                    text-align: left;
                                    padding: 0.4em;
                                }

                                div.nboutput.container div.prompt.empty {
                                    padding: 0;
                                }

                                div.nbinput.container div.prompt > div,
                                div.nboutput.container div.prompt > div {
                                    position: unset;
                                }
                            }

                            /* disable scrollbars on prompts */
                            div.nbinput.container div.prompt pre,
                            div.nboutput.container div.prompt pre {
                                overflow: hidden;
                            }

                            /* input/output area */
                            div.nbinput.container div.input_area,
                            div.nboutput.container div.output_area {
                                -webkit-flex: 1;
                                flex: 1;
                                overflow: auto;
                            }

                            @media (max-width: 540px) {
                                div.nbinput.container div.input_area,
                                div.nboutput.container div.output_area {
                                    width: 100%;
                                }
                            }

                            /* input area */
                            div.nbinput.container div.input_area {
                                border: 1px solid #e0e0e0;
                                border-radius: 2px;
                                /*background: #f5f5f5;*/
                            }

                            /* override MathJax center alignment in output cells */
                            div.nboutput.container div[class*=MathJax] {
                                text-align: left !important;
                            }

                            /* override sphinx.ext.imgmath center alignment in output cells */
                            div.nboutput.container div.math p {
                                text-align: left;
                            }

                            /* standard error */
                            div.nboutput.container div.output_area.stderr {
                                background: #fdd;
                            }

                            /* ANSI colors */
                            .ansi-black-fg {
                                color: #3E424D;
                            }

                            .ansi-black-bg {
                                background-color: #3E424D;
                            }

                            .ansi-black-intense-fg {
                                color: #282C36;
                            }

                            .ansi-black-intense-bg {
                                background-color: #282C36;
                            }

                            .ansi-red-fg {
                                color: #E75C58;
                            }

                            .ansi-red-bg {
                                background-color: #E75C58;
                            }

                            .ansi-red-intense-fg {
                                color: #B22B31;
                            }

                            .ansi-red-intense-bg {
                                background-color: #B22B31;
                            }

                            .ansi-green-fg {
                                color: #00A250;
                            }

                            .ansi-green-bg {
                                background-color: #00A250;
                            }

                            .ansi-green-intense-fg {
                                color: #007427;
                            }

                            .ansi-green-intense-bg {
                                background-color: #007427;
                            }

                            .ansi-yellow-fg {
                                color: #DDB62B;
                            }

                            .ansi-yellow-bg {
                                background-color: #DDB62B;
                            }

                            .ansi-yellow-intense-fg {
                                color: #B27D12;
                            }

                            .ansi-yellow-intense-bg {
                                background-color: #B27D12;
                            }

                            .ansi-blue-fg {
                                color: #208FFB;
                            }

                            .ansi-blue-bg {
                                background-color: #208FFB;
                            }

                            .ansi-blue-intense-fg {
                                color: #0065CA;
                            }

                            .ansi-blue-intense-bg {
                                background-color: #0065CA;
                            }

                            .ansi-magenta-fg {
                                color: #D160C4;
                            }

                            .ansi-magenta-bg {
                                background-color: #D160C4;
                            }

                            .ansi-magenta-intense-fg {
                                color: #A03196;
                            }

                            .ansi-magenta-intense-bg {
                                background-color: #A03196;
                            }

                            .ansi-cyan-fg {
                                color: #60C6C8;
                            }

                            .ansi-cyan-bg {
                                background-color: #60C6C8;
                            }

                            .ansi-cyan-intense-fg {
                                color: #258F8F;
                            }

                            .ansi-cyan-intense-bg {
                                background-color: #258F8F;
                            }

                            .ansi-white-fg {
                                color: #C5C1B4;
                            }

                            .ansi-white-bg {
                                background-color: #C5C1B4;
                            }

                            .ansi-white-intense-fg {
                                color: #A1A6B2;
                            }

                            .ansi-white-intense-bg {
                                background-color: #A1A6B2;
                            }

                            .ansi-default-inverse-fg {
                                color: #FFFFFF;
                            }

                            .ansi-default-inverse-bg {
                                background-color: #000000;
                            }

                            .ansi-bold {
                                font-weight: bold;
                            }

                            .ansi-underline {
                                text-decoration: underline;
                            }


                            div.nbinput.container div.input_area div[class*=highlight] > pre,
                            div.nboutput.container div.output_area div[class*=highlight] > pre,
                            div.nboutput.container div.output_area div[class*=highlight].math,
                            div.nboutput.container div.output_area.rendered_html,
                            div.nboutput.container div.output_area > div.output_javascript,
                            div.nboutput.container div.output_area:not(.rendered_html) > img {
                                padding: 5px;
                                margin: 0;
                            }

                            /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
                            div.nbinput.container div.input_area > div[class^='highlight'],
                            div.nboutput.container div.output_area > div[class^='highlight'] {
                                overflow-y: hidden;
                            }

                            /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
                            .prompt a.copybtn {
                                display: none;
                            }

                            /* Some additional styling taken form the Jupyter notebook CSS */
                            div.rendered_html table {
                                border: none;
                                border-collapse: collapse;
                                border-spacing: 0;
                                color: black;
                                font-size: 12px;
                                table-layout: fixed;
                            }

                            div.rendered_html thead {
                                border-bottom: 1px solid black;
                                vertical-align: bottom;
                            }

                            div.rendered_html tr,
                            div.rendered_html th,
                            div.rendered_html td {
                                text-align: right;
                                vertical-align: middle;
                                padding: 0.5em 0.5em;
                                line-height: normal;
                                white-space: normal;
                                max-width: none;
                                border: none;
                            }

                            div.rendered_html th {
                                font-weight: bold;
                            }

                            div.rendered_html tbody tr:nth-child(odd) {
                                background: #f5f5f5;
                            }

                            div.rendered_html tbody tr:hover {
                                background: rgba(66, 165, 245, 0.2);
                            }

                            /* CSS overrides for sphinx_rtd_theme */

                            /* 24px margin */
                            .nbinput.nblast.container,
                            .nboutput.nblast.container {
                                margin-bottom: 19px; /* padding has already 5px */
                            }

                            /* ... except between code cells! */
                            .nblast.container + .nbinput.container {
                                margin-top: -19px;
                            }

                            .admonition > p:before {
                                margin-right: 4px; /* make room for the exclamation icon */
                            }

                            /* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
                            .math {
                                text-align: unset;
                            }
                        </style>
                        <div class="section" id="Shallow-donor-in-Si">
                            <h1>Shallow donor in Si<a class="headerlink" href="#Shallow-donor-in-Si"
                                                      title="Permalink to this headline">¶</a></h1>
                            <p>Example of more complicated simulations, in which we compare coherence predicted with
                                point dipole hyperfine and one obtainde using the hyperfines from model wave funtion of
                                the shallow donnor in Si (P:Si).</p>
                            <div class="nbinput nblast docutils container">
                                <div class="prompt highlight-none notranslate">
                                    <div class="highlight"><pre><span></span>[1]:
</pre>
                                    </div>
                                </div>
                                <div class="input_area highlight-ipython3 notranslate">
                                    <div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span
                                            class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span
                                            class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">ase</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span
                                            class="p">(</span><span class="s1">&#39;/home/onizhuk/midway/codes_development/pyCCE&#39;</span><span
                                            class="p">)</span>
<span class="kn">import</span> <span class="nn">pycce</span> <span class="k">as</span> <span class="nn">pc</span>

<span class="n">seed</span> <span class="o">=</span> <span class="mi">8800</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span
                                            class="n">suppress</span><span class="o">=</span><span
                                            class="kc">True</span><span class="p">,</span> <span
                                            class="n">precision</span><span class="o">=</span><span
                                            class="mi">5</span><span class="p">)</span>
</pre>
                                    </div>
                                </div>
                            </div>
                            <p>First, as always, generate spin bath with <code
                                    class="docutils literal notranslate"><span class="pre">BathCell</span></code>
                                instance. To get parameters we use ase interface. It allows to conveniently read
                                structure files of any type.</p>
                            <div class="nbinput nblast docutils container">
                                <div class="prompt highlight-none notranslate">
                                    <div class="highlight"><pre><span></span>[2]:
</pre>
                                    </div>
                                </div>
                                <div class="input_area highlight-ipython3 notranslate">
                                    <div class="highlight"><pre>
<span></span><span class="c1"># Generate unitcell from ase</span>
<span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">io</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span
                                            class="n">read</span><span class="p">(</span><span class="s1">&#39;si.cif&#39;</span><span
                                            class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span
                                            class="n">bath</span><span class="o">.</span><span class="n">BathCell</span><span
                                            class="o">.</span><span class="n">from_ase</span><span
                                            class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1"># Add types of isotopes</span>
<span class="n">s</span><span class="o">.</span><span class="n">add_isotopes</span><span class="p">((</span><span
                                            class="s1">&#39;29Si&#39;</span><span class="p">,</span> <span class="mf">0.047</span><span
                                            class="p">))</span>
<span class="c1"># set z direction of the defect</span>
<span class="n">s</span><span class="o">.</span><span class="n">zdir</span> <span class="o">=</span> <span
                                            class="p">[</span><span class="mi">1</span><span class="p">,</span> <span
                                            class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span
                                            class="p">]</span>
<span class="c1"># Generate supercell</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">gen_supercell</span><span
                                            class="p">(</span><span class="mi">200</span><span class="p">,</span> <span
                                            class="n">remove</span><span class="o">=</span><span
                                            class="p">[(</span><span class="s1">&#39;Si&#39;</span><span
                                            class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span
                                            class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span
                                            class="mf">0.</span><span class="p">])],</span> <span
                                            class="n">seed</span><span class="o">=</span><span
                                            class="n">seed</span><span class="p">)</span>
</pre>
                                    </div>
                                </div>
                            </div>
                            <div class="section" id="Calculations-with-point-dipole-hyperfines">
                                <h2>Calculations with point dipole hyperfines<a class="headerlink"
                                                                                href="#Calculations-with-point-dipole-hyperfines"
                                                                                title="Permalink to this headline">¶</a>
                                </h2>
                                <p>Here we compute Hahn-echo decay with point dipole hyperfine couplings. All of the
                                    parameters are converged, however it never hurts to check!</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[3]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="c1"># Parameters of CCE calculations engine</span>

<span class="c1"># Order of CCE aproximation</span>
<span class="n">CCE_order</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Bath cutoff radius</span>
<span class="n">r_bath</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># in A</span>
<span class="c1"># Cluster cutoff radius</span>
<span class="n">r_dipole</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># in A</span>

<span class="c1"># position of central spin</span>
<span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># Qubit levels (in Sz basis)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">1</span><span
                                                class="p">];</span> <span class="n">beta</span> <span class="o">=</span> <span
                                                class="p">[</span><span class="mi">1</span><span
                                                class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># Mag. Field (Bx By Bz)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">array</span><span class="p">([</span><span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">0</span><span
                                                class="p">,</span> <span class="mi">1000</span><span class="p">])</span>  <span
                                                class="c1"># in G</span>
<span class="c1"># Number of pulses in CPMG seq (0 = FID, 1 = HE etc)</span>
<span class="n">pulses</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Setting the runner engine</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Simulator</span><span
                                                class="p">(</span><span class="n">spin</span><span
                                                class="o">=</span><span class="mf">0.5</span><span
                                                class="p">,</span> <span class="n">position</span><span
                                                class="o">=</span><span class="n">position</span><span
                                                class="p">,</span> <span class="n">alpha</span><span
                                                class="o">=</span><span class="n">alpha</span><span
                                                class="p">,</span> <span class="n">beta</span><span
                                                class="o">=</span><span class="n">beta</span><span class="p">,</span>
                    <span class="n">bath</span><span class="o">=</span><span class="n">atoms</span><span
                                                class="p">,</span> <span class="n">r_bath</span><span class="o">=</span><span
                                                class="n">r_bath</span><span class="p">,</span> <span class="n">magnetic_field</span><span
                                                class="o">=</span><span class="n">B</span><span class="p">,</span> <span
                                                class="n">pulses</span><span class="o">=</span><span
                                                class="n">pulses</span><span class="p">,</span>
                    <span class="n">r_dipole</span><span class="o">=</span><span class="n">r_dipole</span><span
                                                class="p">,</span> <span class="n">order</span><span
                                                class="o">=</span><span class="n">CCE_order</span><span
                                                class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[4]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="c1"># Time points</span>
<span class="n">time_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">linspace</span><span class="p">(</span><span
                                                class="mi">0</span><span class="p">,</span> <span
                                                class="mi">2</span><span class="p">,</span> <span
                                                class="mi">201</span><span class="p">)</span>  <span
                                                class="c1"># in ms</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>For comparison, we compute both with generalized CCE and usual CCE coherence. Note a
                                    relatively large bath (<code class="docutils literal notranslate"><span class="pre">r_bath</span>
                                        <span class="pre">=</span> <span class="pre">80</span></code>), so the
                                    calculations will take some time.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[5]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">l_cce</span> <span class="o">=</span> <span class="n">calc</span><span
                                                class="o">.</span><span class="n">compute</span><span class="p">(</span><span
                                                class="n">time_space</span><span class="p">,</span> <span class="n">method</span><span
                                                class="o">=</span><span class="s1">&#39;CCE&#39;</span><span
                                                class="p">)</span>
<span class="n">l_gen</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                class="n">compute</span><span class="p">(</span><span class="n">time_space</span><span
                                                class="p">,</span> <span class="n">method</span><span class="o">=</span><span
                                                class="s1">&#39;gCCE&#39;</span><span class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="section" id="Hyperfines-of-the-shallow-donor">
                                <h2>Hyperfines of the shallow donor<a class="headerlink"
                                                                      href="#Hyperfines-of-the-shallow-donor"
                                                                      title="Permalink to this headline">¶</a></h2>
                                <p>We compute the hyperfine couplings of the shallow donnor, following the formulae by
                                    Rogerio de Sousa and S. Das Sarma (<a class="reference external"
                                                                          href="https://doi.org/10.1103/PhysRevB.68.115322">Phys
                                        Rev B 68, 115322 (2003)</a>).</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[6]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="c1"># PHYSICAL REVIEW B 68, 115322 (2003)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mf">0.81</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">25.09</span>

<span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="n">x</span><span
                                                class="p">,</span> <span class="n">y</span><span
                                                class="p">,</span> <span class="n">z</span><span
                                                class="p">,</span> <span class="n">n</span><span class="o">=</span><span
                                                class="mf">0.81</span><span class="p">,</span> <span
                                                class="n">a</span><span class="o">=</span><span
                                                class="mf">25.09</span><span class="p">,</span> <span class="n">b</span><span
                                                class="o">=</span><span class="mf">14.43</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">exp</span><span class="p">(</span><span
                                                class="o">-</span><span class="n">np</span><span class="o">.</span><span
                                                class="n">sqrt</span><span class="p">(</span><span
                                                class="n">x</span><span class="o">**</span><span
                                                class="mi">2</span><span class="o">/</span><span class="p">(</span><span
                                                class="n">n</span><span class="o">*</span><span class="n">b</span><span
                                                class="p">)</span><span class="o">**</span><span
                                                class="mi">2</span> <span class="o">+</span> <span
                                                class="p">(</span><span class="n">y</span><span class="o">**</span><span
                                                class="mi">2</span> <span class="o">+</span> <span
                                                class="n">z</span><span class="o">**</span><span
                                                class="mi">2</span><span class="p">)</span><span class="o">/</span><span
                                                class="p">(</span><span class="n">n</span><span class="o">*</span><span
                                                class="n">a</span><span class="p">)</span><span class="o">**</span><span
                                                class="mi">2</span><span class="p">))</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span
                                                class="n">sqrt</span><span class="p">(</span><span
                                                class="n">np</span><span class="o">.</span><span
                                                class="n">pi</span> <span class="o">*</span> <span
                                                class="p">(</span><span class="n">n</span> <span
                                                class="o">*</span> <span class="n">a</span><span class="p">)</span><span
                                                class="o">**</span><span class="mi">2</span> <span
                                                class="o">*</span> <span class="p">(</span><span
                                                class="n">n</span> <span class="o">*</span> <span
                                                class="n">b</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bottom</span>

<span class="k">def</span> <span class="nf">contact_si</span><span class="p">(</span><span class="n">r</span><span
                                                class="p">,</span> <span class="n">gamma_n</span><span
                                                class="p">,</span> <span class="n">gamma_e</span><span
                                                class="o">=</span><span class="n">pc</span><span class="o">.</span><span
                                                class="n">ELECTRON_GYRO</span><span class="p">,</span> <span class="n">a_lattice</span><span
                                                class="o">=</span><span class="mf">5.43</span><span
                                                class="p">,</span> <span class="n">nu</span><span
                                                class="o">=</span><span class="mi">186</span><span
                                                class="p">,</span> <span class="n">n</span><span class="o">=</span><span
                                                class="mf">0.81</span><span class="p">,</span> <span
                                                class="n">a</span><span class="o">=</span><span
                                                class="mf">25.09</span><span class="p">,</span> <span class="n">b</span><span
                                                class="o">=</span><span class="mf">14.43</span><span class="p">):</span>
    <span class="n">k0</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="o">*</span> <span
                                                class="mi">2</span> <span class="o">*</span> <span
                                                class="n">np</span><span class="o">.</span><span
                                                class="n">pi</span> <span class="o">/</span> <span
                                                class="n">a_lattice</span>
    <span class="n">pre</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">/</span> <span
                                                class="mi">9</span> <span class="o">*</span> <span
                                                class="n">gamma_n</span> <span class="o">*</span> <span class="n">gamma_e</span> <span
                                                class="o">*</span> <span class="n">pc</span><span
                                                class="o">.</span><span class="n">HBAR</span> <span
                                                class="o">*</span> <span class="n">nu</span>
    <span class="n">xpart</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span
                                                class="n">r</span><span class="p">[</span><span class="mi">0</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">1</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">2</span><span
                                                class="p">],</span> <span class="n">n</span><span
                                                class="o">=</span><span class="n">n</span><span class="p">,</span> <span
                                                class="n">a</span><span class="o">=</span><span class="n">a</span><span
                                                class="p">,</span> <span class="n">b</span><span class="o">=</span><span
                                                class="n">b</span><span class="p">)</span> <span
                                                class="o">*</span> <span class="n">np</span><span
                                                class="o">.</span><span class="n">cos</span><span
                                                class="p">(</span><span class="n">k0</span> <span
                                                class="o">*</span> <span class="n">r</span><span class="p">[</span><span
                                                class="mi">0</span><span class="p">])</span>
    <span class="n">ypart</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span
                                                class="n">r</span><span class="p">[</span><span class="mi">1</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">2</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">0</span><span
                                                class="p">],</span> <span class="n">n</span><span
                                                class="o">=</span><span class="n">n</span><span class="p">,</span> <span
                                                class="n">a</span><span class="o">=</span><span class="n">a</span><span
                                                class="p">,</span> <span class="n">b</span><span class="o">=</span><span
                                                class="n">b</span><span class="p">)</span> <span
                                                class="o">*</span> <span class="n">np</span><span
                                                class="o">.</span><span class="n">cos</span><span
                                                class="p">(</span><span class="n">k0</span> <span
                                                class="o">*</span> <span class="n">r</span><span class="p">[</span><span
                                                class="mi">1</span><span class="p">])</span>
    <span class="n">zpart</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span
                                                class="n">r</span><span class="p">[</span><span class="mi">2</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">0</span><span
                                                class="p">],</span> <span class="n">r</span><span
                                                class="p">[</span><span class="mi">1</span><span
                                                class="p">],</span> <span class="n">n</span><span
                                                class="o">=</span><span class="n">n</span><span class="p">,</span> <span
                                                class="n">a</span><span class="o">=</span><span class="n">a</span><span
                                                class="p">,</span> <span class="n">b</span><span class="o">=</span><span
                                                class="n">b</span><span class="p">)</span> <span
                                                class="o">*</span> <span class="n">np</span><span
                                                class="o">.</span><span class="n">cos</span><span
                                                class="p">(</span><span class="n">k0</span> <span
                                                class="o">*</span> <span class="n">r</span><span class="p">[</span><span
                                                class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pre</span> <span class="o">*</span> <span class="p">(</span><span
                                                class="n">xpart</span> <span class="o">+</span> <span
                                                class="n">ypart</span> <span class="o">+</span> <span
                                                class="n">zpart</span><span class="p">)</span> <span class="o">**</span> <span
                                                class="mi">2</span>

</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>We make a copy of the <code class="docutils literal notranslate"><span class="pre">BathArray</span></code>
                                    object, and set up their hyperfines according to the reference above.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[7]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">newatoms</span> <span class="o">=</span> <span class="n">atoms</span><span
                                                class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Generate hyperfine from point dipole</span>
<span class="n">newatoms</span><span class="o">.</span><span class="n">from_point_dipole</span><span
                                                class="p">(</span><span class="n">position</span><span
                                                class="p">)</span>

<span class="c1"># Following PRB paper</span>
<span class="n">newatoms</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span
                                                class="n">newatoms</span><span class="o">.</span><span
                                                class="n">dist</span><span class="p">()</span> <span
                                                class="o">&lt;</span> <span class="n">n</span><span
                                                class="o">*</span><span class="n">a</span><span class="p">]</span> <span
                                                class="o">=</span> <span class="mi">0</span>
<span class="n">newatoms</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span
                                                class="o">+=</span> <span class="n">np</span><span
                                                class="o">.</span><span class="n">eye</span><span
                                                class="p">(</span><span class="mi">3</span><span
                                                class="p">)[</span><span class="n">np</span><span
                                                class="o">.</span><span class="n">newaxis</span><span
                                                class="p">,:,:]</span> <span class="o">*</span> <span class="n">contact_si</span><span
                                                class="p">(</span><span class="n">newatoms</span><span
                                                class="p">[</span><span class="s1">&#39;xyz&#39;</span><span
                                                class="p">]</span><span class="o">.</span><span class="n">T</span><span
                                                class="p">,</span> <span class="n">newatoms</span><span
                                                class="o">.</span><span class="n">types</span><span
                                                class="p">[</span><span class="s1">&#39;29Si&#39;</span><span class="p">]</span><span
                                                class="o">.</span><span class="n">gyro</span><span class="p">)[:,</span><span
                                                class="n">np</span><span class="o">.</span><span
                                                class="n">newaxis</span><span class="p">,</span> <span
                                                class="n">np</span><span class="o">.</span><span
                                                class="n">newaxis</span><span class="p">]</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>Now we set up a <code class="docutils literal notranslate"><span class="pre">Simulator</span></code>
                                    object. Because hyperfines in <code class="docutils literal notranslate"><span
                                            class="pre">newatoms</span></code> are nonzero, they are
                                    <strong>not</strong> approximated as the ones of point dipole.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[8]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">calc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span
                                                class="n">Simulator</span><span class="p">(</span><span
                                                class="n">spin</span><span class="o">=</span><span class="mf">0.5</span><span
                                                class="p">,</span> <span class="n">position</span><span
                                                class="o">=</span><span class="n">position</span><span
                                                class="p">,</span> <span class="n">alpha</span><span
                                                class="o">=</span><span class="n">alpha</span><span
                                                class="p">,</span> <span class="n">beta</span><span
                                                class="o">=</span><span class="n">beta</span><span class="p">,</span>
                    <span class="n">bath</span><span class="o">=</span><span class="n">newatoms</span><span
                                                class="p">,</span> <span class="n">r_bath</span><span class="o">=</span><span
                                                class="n">r_bath</span><span class="p">,</span> <span class="n">magnetic_field</span><span
                                                class="o">=</span><span class="n">B</span><span class="p">,</span> <span
                                                class="n">pulses</span><span class="o">=</span><span
                                                class="n">pulses</span><span class="p">,</span>
                    <span class="n">r_dipole</span><span class="o">=</span><span class="n">r_dipole</span><span
                                                class="p">,</span> <span class="n">order</span><span
                                                class="o">=</span><span class="n">CCE_order</span><span
                                                class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[9]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">shallow_l_cce</span> <span class="o">=</span> <span class="n">calc</span><span
                                                class="o">.</span><span class="n">compute</span><span class="p">(</span><span
                                                class="n">time_space</span><span class="p">,</span> <span class="n">method</span><span
                                                class="o">=</span><span class="s1">&#39;CCE&#39;</span><span
                                                class="p">)</span>
<span class="n">shallow_l_gen</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span
                                                class="n">compute</span><span class="p">(</span><span class="n">time_space</span><span
                                                class="p">,</span> <span class="n">method</span><span class="o">=</span><span
                                                class="s1">&#39;gCCE&#39;</span><span class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="section" id="Compare-the-results">
                                <h2>Compare the results<a class="headerlink" href="#Compare-the-results"
                                                          title="Permalink to this headline">¶</a></h2>
                                <div class="nbinput docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight"><pre><span></span>[10]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span
                                                class="n">time_space</span><span class="p">,</span> <span class="n">shallow_l_cce</span><span
                                                class="o">.</span><span class="n">real</span><span
                                                class="p">,</span> <span class="n">label</span><span
                                                class="o">=</span><span class="s1">&#39;Shallow&#39;</span><span
                                                class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_space</span><span
                                                class="p">,</span> <span class="n">shallow_l_gen</span><span
                                                class="o">.</span><span class="n">real</span><span
                                                class="p">,</span> <span class="n">ls</span><span
                                                class="o">=</span><span class="s1">&#39;:&#39;</span><span
                                                class="p">,</span> <span class="n">c</span><span class="o">=</span><span
                                                class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_space</span><span
                                                class="p">,</span> <span class="n">l_cce</span><span
                                                class="o">.</span><span class="n">real</span><span
                                                class="p">,</span> <span class="n">label</span><span
                                                class="o">=</span><span class="s1">&#39;PD&#39;</span><span
                                                class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_space</span><span
                                                class="p">,</span> <span class="n">l_gen</span><span
                                                class="o">.</span><span class="n">real</span><span
                                                class="p">,</span> <span class="n">ls</span><span
                                                class="o">=</span><span class="s1">&#39;:&#39;</span><span
                                                class="p">,</span> <span class="n">c</span><span class="o">=</span><span
                                                class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput nblast docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <img alt="../_images/tutorials_si_shallow_17_0.png"
                                             src="../_images/tutorials_si_shallow_17_0.png"/>
                                    </div>
                                </div>
                                <p>Interesting to note - the decay depends significantly on the orientation of the
                                    magnetic field. You can check it yourself!</p>
                            </div>
                        </div>


                    </div>

                </div>
                <footer>
                    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
                        <a href="classical_noise.html" class="btn btn-neutral float-right" title="Correlation function"
                           accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"
                                                               aria-hidden="true"></span></a>
                        <a href="sic_vv.html" class="btn btn-neutral float-left" title="VV in SiC" accesskey="p"
                           rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
                    </div>

                    <hr/>

                    <div role="contentinfo">
                        <p>
                            &#169; Copyright 2021, Mykyta Onizhuk et al.

                        </p>
                    </div>


                    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a

                    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>

                    provided by <a href="https://readthedocs.org">Read the Docs</a>.

                </footer>
            </div>
        </div>

    </section>

</div>


<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
    });
</script>


</body>
</html>