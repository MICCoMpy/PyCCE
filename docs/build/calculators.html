<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
    <meta charset="utf-8"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>CCE Calculators &mdash; pyCCE 0.5.1 documentation</title>


    <link rel="stylesheet" href="_static/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css"/>
    <link rel="stylesheet" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css"/>
    <link rel="stylesheet" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css"/>
    <link rel="stylesheet" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css"/>


    <link rel="shortcut icon" href="_static/favicon.png"/>


    <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
    <![endif]-->


    <script type="text/javascript" id="documentation_options" data-url_root="./"
            src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
            src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="_static/mathjax/tex-chtml.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})
    </script>

    <script type="text/javascript" src="_static/js/theme.js"></script>


    <link rel="index" title="Index" href="genindex.html"/>
    <link rel="search" title="Search" href="search.html"/>
    <link rel="next" title="Hamiltonian functions" href="hamiltonian.html"/>
    <link rel="prev" title="Interfacing with DFT output" href="dft.html"/>
</head>

<body class="wy-body-for-nav">


<div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
        <div class="wy-side-scroll">
            <div class="wy-side-nav-search">


                <a href="index.html">


                    <img src="_static/logo_white.svg" class="logo" alt="Logo"/>

                </a>


                <div role="search">
                    <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
                        <input type="text" name="q" placeholder="Search docs"/>
                        <input type="hidden" name="check_keywords" value="yes"/>
                        <input type="hidden" name="area" value="default"/>
                    </form>
                </div>


            </div>


            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">


                <p class="caption"><span class="caption-text">Getting Started</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="theory.html">Theoretical Background</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
                </ul>
                <p class="caption"><span class="caption-text">User Manual</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="bath.html">Generating the Spin bath</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="simulator.html">Running the
                        simulations</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="parameters.html">Hamiltonian parameters
                        input</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="dft.html">Interfacing with DFT output</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Additional Documentation</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="current reference internal" href="#">CCE Calculators</a>
                        <ul>
                            <li class="toctree-l2"><a class="reference internal"
                                                      href="#cluster-correlation-expansion-decorator">Cluster-correlation
                                expansion decorator</a></li>
                            <li class="toctree-l2"><a class="reference internal"
                                                      href="#module-pycce.calculators.coherence_function">Conventional
                                CCE</a></li>
                            <li class="toctree-l2"><a class="reference internal"
                                                      href="#module-pycce.calculators.density_matrix">Generalized
                                CCE</a></li>
                            <li class="toctree-l2"><a class="reference internal"
                                                      href="#module-pycce.calculators.correlation_function">Noise
                                autocorrelation</a></li>
                        </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="hamiltonian.html">Hamiltonian
                        functions</a></li>
                    <li class="toctree-l1"><a class="reference internal" href="utilities.html">Utility functions</a>
                    </li>
                </ul>


            </div>

        </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


        <nav class="wy-nav-top" aria-label="top navigation">

            <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
            <a href="index.html">pyCCE</a>

        </nav>


        <div class="wy-nav-content">

            <div class="rst-content">


                <div role="navigation" aria-label="breadcrumbs navigation">

                    <ul class="wy-breadcrumbs">

                        <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>

                        <li>CCE Calculators</li>


                        <li class="wy-breadcrumbs-aside">


                            <a href="_sources/calculators.rst.txt" rel="nofollow"> View page source</a>


                        </li>

                    </ul>


                    <hr/>
                </div>
                <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                    <div itemprop="articleBody">


                        <style>
                            /* CSS overrides for sphinx_rtd_theme */

                            /* 24px margin */
                            .nbinput.nblast.container,
                            .nboutput.nblast.container {
                                margin-bottom: 19px; /* padding has already 5px */
                            }

                            /* ... except between code cells! */
                            .nblast.container + .nbinput.container {
                                margin-top: -19px;
                            }

                            .admonition > p:before {
                                margin-right: 4px; /* make room for the exclamation icon */
                            }

                            /* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
                            .math {
                                text-align: unset;
                            }
                        </style>
                        <div class="section" id="cce-calculators">
                            <h1>CCE Calculators<a class="headerlink" href="#cce-calculators"
                                                  title="Permalink to this headline">¶</a></h1>
                            <p>Documentation for the calculator functions called by <code
                                    class="docutils literal notranslate"><span class="pre">Simulator</span></code>
                                object.</p>
                            <div class="section" id="cluster-correlation-expansion-decorator">
                                <h2>Cluster-correlation expansion decorator<a class="headerlink"
                                                                              href="#cluster-correlation-expansion-decorator"
                                                                              title="Permalink to this headline">¶</a>
                                </h2>
                                <p>The way we find cluster in the code.</p>
                                <span class="target" id="module-pycce.find_clusters"></span>
                                <dl class="py function">
                                    <dt id="pycce.find_clusters.generate_clusters">
                                        <code class="sig-name descname">generate_clusters</code><span class="sig-paren">(</span><em
                                            class="sig-param"><span class="n">bath</span></em>, <em
                                            class="sig-param"><span class="n">r_dipole</span></em>, <em
                                            class="sig-param"><span class="n">order</span></em>, <em
                                            class="sig-param"><span class="n">r_inner</span><span
                                            class="o">=</span><span class="default_value">0</span></em>, <em
                                            class="sig-param"><span class="n">ignore</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">strong</span><span class="o">=</span><span class="default_value">False</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.find_clusters.generate_clusters"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Generate clusters for the bath spins.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>bath</strong> (<a class="reference internal"
                                                                                     href="bath.html#pycce.bath.array.BathArray"
                                                                                     title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of bath spins.</p></li>
                                                    <li><p><strong>r_dipole</strong> (<em>float</em>) – Maximum
                                                        connectivity distance.</p></li>
                                                    <li><p><strong>order</strong> (<em>int</em>) – Maximum size of the
                                                        clusters to find.</p></li>
                                                    <li><p><strong>r_inner</strong> (<em>float</em>) – Minimum
                                                        connectivity distance.</p></li>
                                                    <li><p><strong>ignore</strong> (<em>list</em><em>
                                                        or </em><em>str</em><em>, </em><em>optional</em>) – If not None,
                                                        includes the names of bath spins which are ignored in the
                                                        cluster generation.</p></li>
                                                    <li><p><strong>strong</strong> (<em>bool</em>) – Whether to find
                                                        only completely interconnected clusters (default False).</p>
                                                    </li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Dictionary with keys corresponding to size of the
                                                cluster,
                                                and value corresponds to ndarray of shape (matrix, N).
                                                Here matrix is the number of clusters of given size, N is the size of
                                                the cluster.
                                                Each row contains indexes of the bath spins included in the given
                                                cluster.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>dict</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.find_clusters.make_graph">
                                        <code class="sig-name descname">make_graph</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span class="n">bath</span></em>,
                                        <em class="sig-param"><span class="n">r_dipole</span></em>, <em
                                            class="sig-param"><span class="n">r_inner</span><span
                                            class="o">=</span><span class="default_value">0</span></em>, <em
                                            class="sig-param"><span class="n">ignore</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">max_size</span><span class="o">=</span><span
                                            class="default_value">5000</span></em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.find_clusters.make_graph"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Make a connectivity matrix for bath spins.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>bath</strong> (<a class="reference internal"
                                                                                     href="bath.html#pycce.bath.array.BathArray"
                                                                                     title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of bath spins.</p></li>
                                                    <li><p><strong>r_dipole</strong> (<em>float</em>) – Maximum
                                                        connectivity distance.</p></li>
                                                    <li><p><strong>r_inner</strong> (<em>float</em>) – Minimum
                                                        connectivity distance.</p></li>
                                                    <li><p><strong>ignore</strong> (<em>list</em><em>
                                                        or </em><em>str</em><em>, </em><em>optional</em>) – If not None,
                                                        includes the names of bath spins which are ignored in the
                                                        cluster generation.</p></li>
                                                    <li><p><strong>max_size</strong> (<em>int</em>) – Maximum size of
                                                        the bath before less optimal (but less memory intensive)
                                                        approach is used.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Connectivity matrix.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>crs_matrix</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.find_clusters.connected_components">
                                        <code class="sig-name descname">connected_components</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">csgraph</span></em>, <em class="sig-param"><span class="n">directed</span><span
                                            class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="n">connection</span><span
                                            class="o">=</span><span class="default_value">'weak'</span></em>, <em
                                            class="sig-param"><span class="n">return_labels</span><span
                                            class="o">=</span><span class="default_value">True</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.find_clusters.connected_components"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Find connected components using <code
                                            class="docutils literal notranslate"><span
                                            class="pre">scipy.sparse.csgraph</span></code>.
                                        See documentation of <code class="docutils literal notranslate"><span
                                                class="pre">scipy.sparse.csgraph.connected_components</span></code></p>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.find_clusters.find_subclusters">
                                        <code class="sig-name descname">find_subclusters</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span class="n">maximum_order</span></em>,
                                        <em class="sig-param"><span class="n">graph</span></em>, <em
                                            class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span
                                            class="n">n_components</span></em>, <em class="sig-param"><span class="n">strong</span><span
                                            class="o">=</span><span class="default_value">False</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.find_clusters.find_subclusters"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Find subclusters from connectivity matrix.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>maximum_order</strong> (<em>int</em>) – Maximum size
                                                        of the clusters to find.</p></li>
                                                    <li><p><strong>graph</strong> (<em>csr_matrix</em>) – Connectivity
                                                        matrix.</p></li>
                                                    <li><p><strong>labels</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>n</em><em>,</em><em>)</em>) – Array of labels of the
                                                        connected components.</p></li>
                                                    <li><p><strong>n_components</strong> (<em>int</em>) – The number of
                                                        connected components n.</p></li>
                                                    <li><p><strong>strong</strong> (<em>bool</em>) – Whether to find
                                                        only completely interconnected clusters (default False).</p>
                                                    </li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Dictionary with keys corresponding to size of the
                                                cluster,
                                                and value corresponds to ndarray of shape (matrix, N).
                                                Here matrix is the number of clusters of given size, N is the size of
                                                the cluster.
                                                Each row contains indexes of the bath spins included in the given
                                                cluster.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>dict</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.find_clusters.combine_clusters">
                                        <code class="sig-name descname">combine_clusters</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cs1</span></em>, <em class="sig-param"><span class="n">cs2</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.find_clusters.combine_clusters"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Combine two dictionaries with clusters.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cs1</strong> (<em>dict</em>) – First cluster
                                                        dictionary with keys corresponding to size of the cluster,
                                                        and value corresponds to ndarray of shape (matrix, N).</p></li>
                                                    <li><p><strong>cs2</strong> (<em>dict</em>) – Second cluster
                                                        dictionary with the same structure.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Combined dictionary with unique clusters from both
                                                dictionaries.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>dict</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.find_clusters.expand_clusters">
                                        <code class="sig-name descname">expand_clusters</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">sc</span></em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.find_clusters.expand_clusters"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Expand dict so each new cluster will include all possible additions of one
                                        more bath spin. This increases
                                        maximum size of the cluster by one.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd"><p><strong>sc</strong> (<em>dict</em>) – Initial
                                                clusters dictionary.</p>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Dictionary with expanded clusters.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>dict</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <p>General decorator that can expand any function acting on the cluster to the whole
                                    bath <em>via</em> CCE.</p>
                                <span class="target" id="module-pycce.cluster_expansion"></span>
                                <p>This module contains information about the way the cluster expansion is implemented
                                    in the package.</p>
                                <dl class="py function">
                                    <dt id="pycce.cluster_expansion.cluster_expansion_decorator">
                                        <code class="sig-name descname">cluster_expansion_decorator</code><span
                                            class="sig-paren">(</span><em class="sig-param">_func=None</em>, <em
                                            class="sig-param">*</em>, <em class="sig-param">result_operator=&lt;built-in
                                        function imul&gt;</em>, <em class="sig-param">contribution_operator=&lt;built-in
                                        function ipow&gt;</em>, <em class="sig-param">removal_operator=&lt;built-in
                                        function itruediv&gt;</em>, <em class="sig-param">addition_operator=&lt;function
                                        prod&gt;</em><span class="sig-paren">)</span><a class="headerlink"
                                                                                        href="#pycce.cluster_expansion.cluster_expansion_decorator"
                                                                                        title="Permalink to this definition">¶</a>
                                    </dt>
                                    <dd><p>Decorator for creating cluster correlation expansion. Each expanded function
                                        will have two first arguments
                                        and two additional keyword arguments.</p>
                                        <p><strong>Additional parameters</strong>:</p>
                                        <blockquote>
                                            <div>
                                                <ul class="simple">
                                                    <li><p><strong>subclusters</strong> (<em>dict</em>) – Clusters
                                                        included in different CCE orders of structure
                                                        {int order: ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>allspin</strong> (<em>BathArray</em>) – Array of all
                                                        bath spins.</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if
                                                        parallelize calculation of cluster contributions
                                                        over different mpi threads using mpi4py.Default False.</p></li>
                                                    <li><p><strong>direct</strong> (<em>bool</em>) – True if use direct
                                                        approach (requires way more memory
                                                        but might be more numerically stable). False if use memory
                                                        efficient approach. Default False.</p></li>
                                                </ul>
                                            </div>
                                        </blockquote>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>_func</strong> (<em>func</em>) – Function to expand.
                                                    </p></li>
                                                    <li><p><strong>result_operator</strong> (<em>func</em>) – Operator
                                                        which will combine the result of expansion (default:
                                                        operator.imul).</p></li>
                                                    <li><p><strong>contribution_operator</strong> (<em>func</em>) –
                                                        Operator which will combine multiple contributions
                                                        of the same cluster (default: operator.ipow) in the optimized
                                                        approach.</p></li>
                                                    <li><p><strong>result_operator</strong> – Operator which will
                                                        combine the result of expansion (default: operator.imul).</p>
                                                    </li>
                                                    <li><p><strong>removal_operator</strong> (<em>func</em>) – Operator
                                                        which will remove subcluster contribution from the given cluster
                                                        contribution.
                                                        First argument cluster contribution, second - subcluster
                                                        contribution (default: operator.itruediv).</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Expanded function.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>func</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.cluster_expansion.optimized_approach">
                                        <code class="sig-name descname">optimized_approach</code><span
                                            class="sig-paren">(</span><em class="sig-param">function</em>, <em
                                            class="sig-param">subclusters</em>, <em class="sig-param">allspin</em>, <em
                                            class="sig-param">*arg</em>, <em class="sig-param">parallel=False</em>, <em
                                            class="sig-param">result_operator=&lt;built-in function imul&gt;</em>, <em
                                            class="sig-param">contribution_operator=&lt;built-in function ipow&gt;</em>,
                                        <em class="sig-param">**kwarg</em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.cluster_expansion.optimized_approach"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Optimized approach to compute cluster correlation expansion.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>function</strong> (<em>func</em>) – Function to
                                                        expand.</p></li>
                                                    <li><p><strong>subclusters</strong> (<em>dict</em>) – Clusters
                                                        included in different CCE orders of structure {int order:
                                                        ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>*arg</strong> – list of positional arguments of the
                                                        expanded function.</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if
                                                        parallelize calculation of cluster contributions over different
                                                        mpi threads.
                                                        Default False.</p></li>
                                                    <li><p><strong>result_operator</strong> (<em>func</em>) – Operator
                                                        which will combine the result of expansion (default:
                                                        operator.imul).</p></li>
                                                    <li><p><strong>contribution_operator</strong> (<em>func</em>) –
                                                        Operator which will combine multiple contributions
                                                        of the same cluster (default: operator.ipow).</p></li>
                                                    <li><p><strong>**kwarg</strong> – Dictionary containing all keyword
                                                        arguments of the expanded function.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Expanded function.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>func</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.cluster_expansion.direct_approach">
                                        <code class="sig-name descname">direct_approach</code><span
                                            class="sig-paren">(</span><em class="sig-param">function</em>, <em
                                            class="sig-param">subclusters</em>, <em class="sig-param">allspin</em>, <em
                                            class="sig-param">*arg</em>, <em class="sig-param">parallel=False</em>, <em
                                            class="sig-param">result_operator=&lt;built-in function imul&gt;</em>, <em
                                            class="sig-param">removal_operator=&lt;built-in function itruediv&gt;</em>,
                                        <em class="sig-param">addition_operator=&lt;function prod&gt;</em>, <em
                                            class="sig-param">**kwarg</em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.cluster_expansion.direct_approach"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Direct approach to compute cluster correlation expansion.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>function</strong> (<em>func</em>) – Function to
                                                        expand.</p></li>
                                                    <li><p><strong>subclusters</strong> (<em>dict</em>) – Clusters
                                                        included in different CCE orders of structure {int order:
                                                        ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>*arg</strong> – list of positional arguments of the
                                                        expanded function.</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if
                                                        parallelize calculation of cluster contributions over different
                                                        mpi threads.
                                                        Default False.</p></li>
                                                    <li><p><strong>result_operator</strong> (<em>func</em>) – Operator
                                                        which will combine the result of expansion (default:
                                                        operator.imul).</p></li>
                                                    <li><p><strong>removal_operator</strong> (<em>func</em>) – Operator
                                                        which will remove subcluster contribution from the given cluster
                                                        contribution.
                                                        First argument cluster contribution, second - subcluster
                                                        contribution (default: operator.itruediv).</p></li>
                                                    <li><p><strong>addition_operator</strong> (<em>func</em>) – Group
                                                        operation which will combine contributions from the different
                                                        clusters into one
                                                        contribution (default: np.prod).</p></li>
                                                    <li><p><strong>**kwarg</strong> – Dictionary containing all keyword
                                                        arguments of the expanded function.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Expanded function.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>func</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                            </div>
                            <div class="section" id="module-pycce.calculators.coherence_function">
                                <span id="conventional-cce"></span>
                                <h2>Conventional CCE<a class="headerlink"
                                                       href="#module-pycce.calculators.coherence_function"
                                                       title="Permalink to this headline">¶</a></h2>
                                <dl class="py function">
                                    <dt id="pycce.calculators.coherence_function.propagators">
                                        <code class="sig-name descname">propagators</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">timespace</span></em>, <em class="sig-param"><span
                                            class="n">H0</span></em>, <em class="sig-param"><span
                                            class="n">H1</span></em>, <em class="sig-param"><span
                                            class="n">N</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.calculators.coherence_function.propagators"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute propagators U0 and U1 in conventional CCE.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>timespace</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>, </em><em>)</em>) – Time delay values at
                                                        which to compute propagators.</p></li>
                                                    <li><p><strong>H0</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>, </em><em>2s+1</em><em>)</em>) –
                                                        Hamiltonian projected on alpha qubit state.</p></li>
                                                    <li><p><strong>H1</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>, </em><em>2s+1</em><em>)</em>) –
                                                        Hamiltonian projected on beta qubit state.</p></li>
                                                    <li><p><strong>N</strong> (<em>int</em>) – number of pulses in CPMG.
                                                    </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses.
                                                        False if time points are total time.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>
                                                <p><em>tuple</em> containing:</p>
                                                <blockquote>
                                                    <div>
                                                        <ul class="simple">
                                                            <li><p><strong>ndarray with shape (t, 2s+1, 2s+1)</strong>:
                                                                Matrix representation of the propagator conditioned on
                                                                the alpha qubit state for each time point.</p></li>
                                                            <li><p><strong>ndarray with shape (t, 2s+1, 2s+1)</strong>:
                                                                Matrix representation of the propagator conditioned on
                                                                the beta qubit state for each time point.</p></li>
                                                        </ul>
                                                    </div>
                                                </blockquote>
                                                </p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>tuple</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.coherence_function.compute_coherence">
                                        <code class="sig-name descname">compute_coherence</code><span class="sig-paren">(</span><em
                                            class="sig-param"><span class="n">H0</span></em>, <em
                                            class="sig-param"><span class="n">H1</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">states</span><span class="o">=</span><span class="default_value">None</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.coherence_function.compute_coherence"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute cluster coherence function in conventional CCE.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>H0</strong> (<em>ndarray</em>) – Hamiltonian
                                                        projected on alpha qubit state.</p></li>
                                                    <li><p><strong>H1</strong> (<em>ndarray</em>) – Hamiltonian
                                                        projected on beta qubit state.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence function.</p></li>
                                                    <li><p><strong>N</strong> (<em>int</em>) – Number of pulses in CPMG.
                                                    </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses,
                                                        False if time points are total time.</p></li>
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) – ndarray of bath
                                                        states in any accepted format.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Coherence function of the central spin.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>coherence_function (ndarray)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.coherence_function.decorated_coherence_function">
                                        <code class="sig-name descname">decorated_coherence_function</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span class="n">projections_alpha</span></em>,
                                        <em class="sig-param"><span class="n">projections_beta</span></em>, <em
                                            class="sig-param"><span class="n">magnetic_field</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">states</span><span class="o">=</span><span class="default_value">None</span></em>,
                                        <em class="sig-param"><span class="n">projected_states</span><span
                                                class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="o">**</span><span
                                            class="n">kwargs</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.coherence_function.decorated_coherence_function"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Overarching decorated function to compute coherence function in conventional
                                        CCE.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – array of all bath spins</p></li>
                                                    <li><p><strong>projections_alpha</strong> (<em>ndarray</em>) –
                                                        ndarray containing projections of alpha state
                                                        <span class="math notranslate nohighlight">\([raket{\hat{S}_x}, raket{\hat{S}_y}, raket{\hat{S}_z}]\)</span>.
                                                    </p></li>
                                                    <li><p><strong>projections_beta</strong> (<em>ndarray</em>) –
                                                        ndarray containing projections of beta state
                                                        <span class="math notranslate nohighlight">\([raket{\hat{S}_x}, raket{\hat{S}_y}, raket{\hat{S}_z}]\)</span>.
                                                    </p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence.</p></li>
                                                    <li><p><strong>N</strong> (<em>int</em>) – number of pulses in CPMG
                                                        sequence.</p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>states</strong> (<em>list</em>) – list of bath states
                                                        in any accepted format.</p></li>
                                                    <li><p><strong>projected_states</strong> (<em>ndarray</em>) –
                                                        ndarray of <code class="docutils literal notranslate"><span
                                                                class="pre">shape</span> <span class="pre">=</span>
                                                            <span class="pre">len(allspin)</span></code>
                                                        containing z-projections of the bath spins states.</p></li>
                                                    <li><p><strong>**kwargs</strong> (<em>any</em>) – Additional
                                                        arguments for projected_hamiltonian.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Coherence function of the central spin.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>coherence_function (ndarray)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.coherence_function.monte_carlo_coherence">
                                        <code class="sig-name descname">monte_carlo_coherence</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span class="n">projections_alpha</span></em>,
                                        <em class="sig-param"><span class="n">projections_beta</span></em>, <em
                                            class="sig-param"><span class="n">magnetic_field</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">nbstates</span><span class="o">=</span><span
                                            class="default_value">100</span></em>, <em class="sig-param"><span
                                            class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em>,
                                        <em class="sig-param"><span class="n">masked</span><span class="o">=</span><span
                                                class="default_value">True</span></em>, <em class="sig-param"><span
                                            class="n">parallel_states</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">fixstates</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">direct</span><span class="o">=</span><span class="default_value">False</span></em>,
                                        <em class="sig-param"><span class="n">parallel</span><span
                                                class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="o">**</span><span
                                            class="n">kwargs</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.coherence_function.monte_carlo_coherence"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Compute coherence of the central spin using conventional CCE with Monte-Carlo
                                        bath state sampling.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – array of all bath spins.</p></li>
                                                    <li><p><strong>projections_alpha</strong> (<em>ndarray</em>) –
                                                        ndarray containing projections of alpha state
                                                        <span class="math notranslate nohighlight">\([\braket{\hat{S}_x}, \braket{\hat{S}_y}, \braket{\hat{S}_z}]\)</span>.
                                                    </p></li>
                                                    <li><p><strong>projections_beta</strong> (<em>ndarray</em>) –
                                                        ndarray containing projections of beta state
                                                        <span class="math notranslate nohighlight">\([\braket{\hat{S}_x}, \braket{\hat{S}_y}, \braket{\hat{S}_z}]\)</span>.
                                                    </p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence.</p></li>
                                                    <li><p><strong>N</strong> (<em>int</em>) – number of pulses in CPMG
                                                        sequence.</p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>nbstates</strong> (<em>int</em>) – Number of random
                                                        bath states to sample.</p></li>
                                                    <li><p><strong>seed</strong> (<em>int</em>) – Seed for the RNG.</p>
                                                    </li>
                                                    <li><p><strong>masked</strong> (<em>bool</em>) – True if mask
                                                        numerically unstable points (with coherence &gt; 1) in the
                                                        averaging over bath states
                                                        False if not. Default True.</p></li>
                                                    <li><p><strong>parallel_states</strong> (<em>bool</em>) – True if
                                                        use MPI to parallelize the calculations of density matrix
                                                        for each random bath state.</p></li>
                                                    <li><p><strong>fixstates</strong> (<em>dict</em>) – dict of which
                                                        bath states to fix. Each key is the index of bath spin,
                                                        value - fixed <span class="math notranslate nohighlight">\(\hat{I}_z\)</span>
                                                        projection of the mixed state of bath spin.</p></li>
                                                    <li><p><strong>direct</strong> (<em>bool</em>) – True if use the
                                                        direct approach in cluster expansion</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if use MPI
                                                        for parallel computing of the cluster contributions.</p></li>
                                                    <li><p><strong>**kwargs</strong> (<em>any</em>) – Additional keyword
                                                        arguments for the projected_hamiltonian.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>coherence function of the central spin</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>coherence_function (ndarray)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                            </div>
                            <div class="section" id="module-pycce.calculators.density_matrix">
                                <span id="generalized-cce"></span>
                                <h2>Generalized CCE<a class="headerlink" href="#module-pycce.calculators.density_matrix"
                                                      title="Permalink to this headline">¶</a></h2>
                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.propagator">
                                        <code class="sig-name descname">propagator</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">timespace</span></em>, <em class="sig-param"><span class="n">hamiltonian</span></em>,
                                        <em class="sig-param"><span class="n">dimensions</span><span
                                                class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span><span
                                            class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">alpha</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">beta</span><span class="o">=</span><span class="default_value">None</span></em>,
                                        <em class="sig-param"><span class="n">as_delay</span><span
                                                class="o">=</span><span class="default_value">False</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.density_matrix.propagator"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute time propagator U.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute propagators.</p></li>
                                                    <li><p><strong>hamiltonian</strong> (<em>ndarray</em>) – Matrix
                                                        representation of the cluster Hamiltonian.</p></li>
                                                    <li><p><strong>dimensions</strong> (<em>ndarray</em>) – ndarray of
                                                        bath spin dimensions. Last entry - electron spin dimensions.</p>
                                                    </li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>array of propagators, evaluated at each time point
                                                in timespace.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.compute_dm">
                                        <code class="sig-name descname">compute_dm</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span
                                            class="n">H</span></em>, <em class="sig-param"><span class="n">alpha</span></em>,
                                        <em class="sig-param"><span class="n">beta</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span><span
                                            class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">as_delay</span><span
                                            class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="n">states</span><span class="o">=</span><span
                                            class="default_value">None</span></em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.calculators.density_matrix.compute_dm"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute density matrix of the central spin, given Hamiltonian
                                        H.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>dm0</strong> (<em>ndarray</em>) – Initial density
                                                        matrix of central spin.</p></li>
                                                    <li><p><strong>H</strong> (<em>ndarray</em>) – Cluster Hamiltonian.
                                                    </p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute density matrix.</p></li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) – ndarray of bath
                                                        states in any accepted format.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Array of density matrices evaluated at all time
                                                points in timespace.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.full_dm">
                                        <code class="sig-name descname">full_dm</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span
                                            class="n">H</span></em>, <em class="sig-param"><span class="n">alpha</span></em>,
                                        <em class="sig-param"><span class="n">beta</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span><span
                                            class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">as_delay</span><span
                                            class="o">=</span><span class="default_value">False</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.density_matrix.full_dm"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>A function to compute density matrix of the cluster, using hamiltonian H
                                        from the initial density matrix of the cluster.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>dm0</strong> (<em>ndarray</em>) – Initial density
                                                        matrix of the cluster</p></li>
                                                    <li><p><strong>H</strong> (<em>ndarray</em>) – Cluster Hamiltonian
                                                    </p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence function.</p></li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Array of density matrices of the cluster,
                                                evaluated at the time points from timespace.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.generate_dm0">
                                        <code class="sig-name descname">generate_dm0</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span
                                            class="n">dimensions</span></em>, <em class="sig-param"><span class="n">states</span><span
                                            class="o">=</span><span class="default_value">None</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.density_matrix.generate_dm0"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>A function to generate initial density matrix of the cluster.
                                        :param dm0: Initial density matrix of the central spin.
                                        :type dm0: ndarray
                                        :param dimensions: ndarray of bath spin dimensions. Last entry - electron spin
                                        dimensions.
                                        :type dimensions: ndarray
                                        :param states: ndarray of bath states in any accepted format.
                                        :type states: ndarray</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Returns</dt>
                                            <dd class="field-odd"><p>Initial density matrix of the cluster.</p>
                                            </dd>
                                            <dt class="field-even">Return type</dt>
                                            <dd class="field-even"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.gen_density_matrix">
                                        <code class="sig-name descname">gen_density_matrix</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">states</span><span class="o">=</span><span class="default_value">None</span></em>,
                                        <em class="sig-param"><span class="n">dimensions</span><span
                                                class="o">=</span><span class="default_value">None</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.density_matrix.gen_density_matrix"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Generate density matrix from the ndarray of states.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) –
                                                        <p>Array of bath spin states. If None, assume completely random
                                                            state.
                                                            Can have the following forms:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ul>
                                                                    <li><p>array of the <span
                                                                            class="math notranslate nohighlight">\(\hat{I}_z\)</span>
                                                                        projections for each spin.
                                                                        Assumes that each bath spin is in the pure
                                                                        eigenstate of <span
                                                                                class="math notranslate nohighlight">\(\hat{I}_z\)</span>.
                                                                    </p></li>
                                                                    <li><p>array of the diagonal elements of the density
                                                                        matrix for each spin.
                                                                        Assumes mixed state and the density matrix for
                                                                        each bath spin
                                                                        is diagonal in <span
                                                                                class="math notranslate nohighlight">\(\hat{I}_z\)</span>
                                                                        basis.</p></li>
                                                                    <li><p>array of the density matrices of the bath
                                                                        spins.</p></li>
                                                                </ul>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>dimensions</strong> (<em>ndarray</em>) – array of
                                                        bath spin dimensions. Last entry - electron spin dimensions.</p>
                                                    </li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Density matrix of the system.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.decorated_density_matrix">
                                        <code class="sig-name descname">decorated_density_matrix</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span
                                            class="n">alpha</span></em>, <em class="sig-param"><span
                                            class="n">beta</span></em>, <em class="sig-param"><span class="n">magnetic_field</span></em>,
                                        <em class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span></em>, <em
                                            class="sig-param"><span class="n">gyro_e</span><span class="o">=</span><span
                                            class="default_value">- 17608.59705</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">zeroth_cluster</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">bath_state</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">eta</span><span class="o">=</span><span
                                            class="default_value">None</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.density_matrix.decorated_density_matrix"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Decorated function to compute electron density matrix with gCCE (without mean
                                        field).</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray</em>) – Initial density
                                                        matrix of the central spin.</p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence function.</p></li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>gyro_e</strong> (<em>float</em><em> or </em><em>ndarray
                                                        with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) –
                                                        <p>Gyromagnetic ratio of the central spin</p>
                                                        <p><strong>OR</strong></p>
                                                        <p>tensor corresponding to interaction between magnetic field
                                                            and central spin.</p>
                                                        </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>zeroth_cluster</strong> (<em>ndarray</em>) – Density
                                                        matrix of isolated central spin at all time poins.</p></li>
                                                    <li><p><strong>bath_state</strong> (<em>ndarray</em>) – Array of
                                                        bath states in any accepted format.</p></li>
                                                    <li><p><strong>eta</strong> (<em>float</em>) – Value of eta (see
                                                        eta_hamiltonian)</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Array of central spin density matricies at each
                                                time point.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.mean_field_density_matrix">
                                        <code class="sig-name descname">mean_field_density_matrix</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span
                                            class="n">alpha</span></em>, <em class="sig-param"><span
                                            class="n">beta</span></em>, <em class="sig-param"><span class="n">magnetic_field</span></em>,
                                        <em class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span></em>, <em
                                            class="sig-param"><span class="n">bath_state</span></em>, <em
                                            class="sig-param"><span class="n">gyro_e</span><span class="o">=</span><span
                                            class="default_value">- 17608.59705</span></em>, <em class="sig-param"><span
                                            class="n">as_delay</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">zeroth_cluster</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">projected_bath_state</span><span class="o">=</span><span
                                            class="default_value">None</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.density_matrix.mean_field_density_matrix"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Decorated function to compute electron density matrix with gCCE with mean
                                        field.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray</em>) – Initial density
                                                        matrix of the central spin.</p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>,</em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence function.</p></li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>bath_state</strong> (<em>ndarray</em>) – Array of
                                                        bath states in any accepted format.</p></li>
                                                    <li><p><strong>gyro_e</strong> (<em>float</em><em> or </em><em>ndarray
                                                        with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) –
                                                        <p>Gyromagnetic ratio of the central spin</p>
                                                        <p><strong>OR</strong></p>
                                                        <p>tensor corresponding to interaction between magnetic field
                                                            and
                                                            central spin.</p>
                                                        </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>zeroth_cluster</strong> (<em>ndarray</em>) – Density
                                                        matrix of isolated central spin at all time points.</p></li>
                                                    <li><p><strong>projected_bath_state</strong> (<em>ndarray</em>) –
                                                        Array of <code class="docutils literal notranslate"><span
                                                                class="pre">shape</span> <span class="pre">=</span>
                                                            <span class="pre">len(allspin)</span></code>
                                                        containing z-projections of the bath spins states.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>array of central spin density matrices at each
                                                time point.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.generate_bath_state">
                                        <code class="sig-name descname">generate_bath_state</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span class="n">bath</span></em>,
                                        <em class="sig-param"><span class="n">nbstates</span></em>, <em
                                            class="sig-param"><span class="n">seed</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">fixstates</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">parallel</span><span class="o">=</span><span
                                            class="default_value">False</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.density_matrix.generate_bath_state"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Generator of the random <em>pure</em> <span
                                            class="math notranslate nohighlight">\(\hat{I}_z\)</span> bath eigenstates.
                                    </p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>bath</strong> (<a class="reference internal"
                                                                                     href="bath.html#pycce.bath.array.BathArray"
                                                                                     title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of bath spins.</p></li>
                                                    <li><p><strong>nbstates</strong> (<em>int</em>) – Number of random
                                                        bath states to generate.</p></li>
                                                    <li><p><strong>seed</strong> (<em>int</em>) – Optional. Seed for
                                                        RNG.</p></li>
                                                    <li><p><strong>fixstates</strong> (<em>dict</em>) – Optional. dict
                                                        of which bath states to fix. Each key is the index of bath spin,
                                                        value - fixed <span class="math notranslate nohighlight">\(\hat{I}_z\)</span>
                                                        projection of the mixed state of nuclear spin.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Yields</dt>
                                            <dd class="field-even"><p><em>random_state (ndarray)</em> – Array of <code
                                                    class="docutils literal notranslate"><span class="pre">shape</span>
                                                <span class="pre">=</span> <span class="pre">len(bath)</span></code>
                                                containing z-projections of the bath spins states.</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.density_matrix.monte_carlo_dm">
                                        <code class="sig-name descname">monte_carlo_dm</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">clusters</span></em>, <em class="sig-param"><span
                                            class="n">bath</span></em>, <em class="sig-param"><span class="n">dm0</span></em>,
                                        <em class="sig-param"><span class="n">alpha</span></em>, <em
                                            class="sig-param"><span class="n">beta</span></em>, <em
                                            class="sig-param"><span class="n">magnetic_field</span></em>, <em
                                            class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">pulse_sequence</span></em>, <em
                                            class="sig-param"><span class="n">central_gyro</span><span
                                            class="o">=</span><span class="default_value">- 17608.59705</span></em>, <em
                                            class="sig-param"><span class="n">as_delay</span><span
                                            class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="n">nbstates</span><span
                                            class="o">=</span><span class="default_value">100</span></em>, <em
                                            class="sig-param"><span class="n">seed</span><span class="o">=</span><span
                                            class="default_value">None</span></em>, <em class="sig-param"><span
                                            class="n">masked</span><span class="o">=</span><span class="default_value">True</span></em>,
                                        <em class="sig-param"><span class="n">normalized</span><span
                                                class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">parallel_states</span><span
                                            class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="n">fixstates</span><span
                                            class="o">=</span><span class="default_value">None</span></em>, <em
                                            class="sig-param"><span class="n">direct</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">parallel</span><span class="o">=</span><span
                                            class="default_value">False</span></em><span class="sig-paren">)</span><a
                                            class="headerlink" href="#pycce.calculators.density_matrix.monte_carlo_dm"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Compute density matrix of the central spin using generalized CCE with
                                        Monte-Carlo bath state sampling.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>bath</strong> (<a class="reference internal"
                                                                                     href="bath.html#pycce.bath.array.BathArray"
                                                                                     title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray</em>) – Initial density
                                                        matrix of the central spin.</p></li>
                                                    <li><p><strong>alpha</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>,</em><em>)</em>) – Vector representation
                                                        of the alpha qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>beta</strong> (<em>ndarray with shape</em><em> (</em><em>2s+1</em><em>,</em><em>)</em>)
                                                        – Vector representation of the beta qubit state in <span
                                                                class="math notranslate nohighlight">\(\hat{S}_z\)</span>
                                                        basis.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray</em>) – Time points
                                                        at which to compute coherence function.</p></li>
                                                    <li><p><strong>pulse_sequence</strong> (<em>list</em>) –
                                                        <p>Pulse_sequence should have format of list with tuples,
                                                            each tuple contains two or three entries:</p>
                                                        <blockquote>
                                                            <div>
                                                                <ol class="arabic simple">
                                                                    <li><p>axis the rotation is about;</p></li>
                                                                    <li><p>angle of rotation. E.g. for Hahn-Echo <code
                                                                            class="docutils literal notranslate"><span
                                                                            class="pre">[('x',</span> <span class="pre">np.pi/2)]</span></code>.
                                                                    </p></li>
                                                                    <li><p>(Optional). Fraction of time before the
                                                                        pulse. E.g. for Hahn-Echo <code
                                                                                class="docutils literal notranslate"><span
                                                                                class="pre">[('x',</span> <span
                                                                                class="pre">np.pi/2,</span> <span
                                                                                class="pre">0.5)]</span></code>.</p>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                        </blockquote>
                                                        </p></li>
                                                    <li><p><strong>central_gyro</strong> (<em>float</em><em>
                                                        or </em><em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>,</em><em>3</em><em>)</em>) –
                                                        <p>gyromagnetic ratio of the central spin</p>
                                                        <p><strong>OR</strong></p>
                                                        <p>tensor corresponding to interaction between magnetic field
                                                            and
                                                            central spin.</p>
                                                        </p></li>
                                                    <li><p><strong>as_delay</strong> (<em>bool</em>) – True if time
                                                        points are delay between pulses, False if time points are total
                                                        time.</p></li>
                                                    <li><p><strong>nbstates</strong> (<em>int</em>) – Number of random
                                                        bath states to sample.</p></li>
                                                    <li><p><strong>seed</strong> (<em>int</em>) – Seed for the RNG.</p>
                                                    </li>
                                                    <li><p><strong>masked</strong> (<em>bool</em>) – True if mask
                                                        numerically unstable points (with elements &gt; 1) in the
                                                        averaging over bath states
                                                        False if not. Default True.</p></li>
                                                    <li><p><strong>normalized</strong> (<em>ndarray of bool</em>) –
                                                        which diagonal elements to renormalize,
                                                        so the total sum of the diagonal elements is 1.</p></li>
                                                    <li><p><strong>parallel_states</strong> (<em>bool</em>) – True if
                                                        use MPI to parallelize the calculations of density matrix.
                                                        for each random bath state.</p></li>
                                                    <li><p><strong>fixstates</strong> (<em>dict</em>) – Dictionary with
                                                        bath states to fix. Each key is the index of bath spin,
                                                        value - fixed Sz projection of the mixed state of nuclear spin.
                                                    </p></li>
                                                    <li><p><strong>direct</strong> (<em>bool</em>) – True if use the
                                                        direct approach in cluster expansion.</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if use MPI
                                                        for parallel computing of the cluster contributions.</p></li>
                                                    <li><p><strong>**kwargs</strong> – Additional keyword arguments for
                                                        the projected_hamiltonian.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>array of central spin density matrices at each
                                                time point.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                            </div>
                            <div class="section" id="module-pycce.calculators.correlation_function">
                                <span id="noise-autocorrelation"></span>
                                <h2>Noise autocorrelation<a class="headerlink"
                                                            href="#module-pycce.calculators.correlation_function"
                                                            title="Permalink to this headline">¶</a></h2>
                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.correlation_it_j0">
                                        <code class="sig-name descname">correlation_it_j0</code><span class="sig-paren">(</span><em
                                            class="sig-param"><span class="n">operator_i</span></em>, <em
                                            class="sig-param"><span class="n">operator_j</span></em>, <em
                                            class="sig-param"><span class="n">dm0_expanded</span></em>, <em
                                            class="sig-param"><span class="n">U</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.correlation_function.correlation_it_j0"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute correlation function of the operator i at time t and
                                        operator j at time 0</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>operator_i</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>n</em><em>, </em><em>n</em><em>)</em>) – Matrix
                                                        representation of operator i.</p></li>
                                                    <li><p><strong>operator_j</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>n</em><em>, </em><em>n</em><em>)</em>) – Matrix
                                                        representation of operator j.</p></li>
                                                    <li><p><strong>dm0_expanded</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>n</em><em>, </em><em>n</em><em>)</em>)
                                                        – Initial density matrix of the cluster.</p></li>
                                                    <li><p><strong>U</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>, </em><em>n</em><em>, </em><em>n</em><em>)</em>)
                                                        – Time evolution propagator, evaluated over t time points.</p>
                                                    </li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Autocorrelation of the z-noise at each time
                                                point.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.compute_correlations">
                                        <code class="sig-name descname">compute_correlations</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span class="n">nspin</span></em>,
                                        <em class="sig-param"><span class="n">dm0_expanded</span></em>, <em
                                            class="sig-param"><span class="n">U</span></em>, <em class="sig-param"><span
                                            class="n">central_spin</span><span class="o">=</span><span
                                            class="default_value">None</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.correlation_function.compute_correlations"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Function to compute correlations for the given cluster, given time propagator
                                        U.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>nspin</strong> (<a class="reference internal"
                                                                                      href="bath.html#pycce.bath.array.BathArray"
                                                                                      title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – BathArray of the given cluster of bath spins.</p></li>
                                                    <li><p><strong>dm0_expanded</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>n</em><em>, </em><em>n</em><em>)</em>)
                                                        – Initial density matrix of the cluster.</p></li>
                                                    <li><p><strong>U</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>, </em><em>n</em><em>, </em><em>n</em><em>)</em>)
                                                        – Time evolution propagator, evaluated over t time points.</p>
                                                    </li>
                                                    <li><p><strong>central_spin</strong> (<em>float</em>) – Value of the
                                                        central spin.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>correlation of the Overhauser field, induced by
                                                the given cluster at each time point.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.projected_noise_correlation">
                                        <code class="sig-name descname">projected_noise_correlation</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span class="n">projections_state</span></em>,
                                        <em class="sig-param"><span class="n">magnetic_field</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">states</span><span class="o">=</span><span
                                            class="default_value">None</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.correlation_function.projected_noise_correlation"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Decorated function to compute autocorrelation function with conventional
                                        CCE.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure {int order:
                                                        ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>projections_state</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Array
                                                        containing projections of state state [&lt;Sx&gt;, &lt;Sy&gt;,
                                                        &lt;Sz&gt;].</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Magnetic
                                                        field of type mfield = np.array([Bx, By, Bz]).</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>,</em><em>)</em>) – Time points at which to
                                                        compute autocorrelation.</p></li>
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) – Array of bath
                                                        states in any accepted format.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Autocorrelation of the bath spin noise along
                                                z-axis.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.decorated_noise_correlation">
                                        <code class="sig-name descname">decorated_noise_correlation</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span class="n">magnetic_field</span></em>,
                                        <em class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">gyro_e</span><span class="o">=</span><span
                                            class="default_value">- 17608.59705</span></em>, <em class="sig-param"><span
                                            class="n">states</span><span class="o">=</span><span class="default_value">None</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.correlation_function.decorated_noise_correlation"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Decorated function to compute noise correlation with gCCE (without mean
                                        field).</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure {int order:
                                                        ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>, </em><em>2s+1</em><em>)</em>) – density
                                                        matrix of the initial state of the central spin.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Magnetic
                                                        field of type mfield = np.array([Bx, By, Bz]).</p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>,</em><em>)</em>) – Time points at which to
                                                        compute autocorrelation.</p></li>
                                                    <li><p><strong>gyro_e</strong> (<em>float</em><em> or </em><em>ndarray
                                                        with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Gyromagnetic
                                                        ratio of the central spin OR tensor corresponding to interaction
                                                        between magnetic field and
                                                        central spin.</p></li>
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) – Array of bath
                                                        states in any accepted format.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Autocorrelation of the bath spin noise along
                                                z-axis.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.mean_field_noise_correlation">
                                        <code class="sig-name descname">mean_field_noise_correlation</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">cluster</span></em>, <em class="sig-param"><span
                                            class="n">allspin</span></em>, <em class="sig-param"><span
                                            class="n">dm0</span></em>, <em class="sig-param"><span class="n">magnetic_field</span></em>,
                                        <em class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">bath_state</span></em>, <em
                                            class="sig-param"><span class="n">gyro_e</span><span class="o">=</span><span
                                            class="default_value">- 17608.59705</span></em><span
                                            class="sig-paren">)</span><a class="headerlink"
                                                                         href="#pycce.calculators.correlation_function.mean_field_noise_correlation"
                                                                         title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Decorated function to compute noise autocorrelation function with gCCE and MC
                                        sampling of the bath states.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure <code
                                                                class="docutils literal notranslate"><span class="pre">{int</span>
                                                            <span class="pre">order:</span> <span class="pre">ndarray([[i,j],[i,j]])}</span></code>.
                                                    </p></li>
                                                    <li><p><strong>allspin</strong> (<a class="reference internal"
                                                                                        href="bath.html#pycce.bath.array.BathArray"
                                                                                        title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>, </em><em>2s+1</em><em>)</em>) – Density
                                                        matrix of the initial state of the central spin.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Magnetic
                                                        field of type <code class="docutils literal notranslate"><span
                                                                class="pre">mfield</span> <span class="pre">=</span>
                                                            <span class="pre">np.array([Bx,</span> <span
                                                                    class="pre">By,</span> <span class="pre">Bz])</span></code>.
                                                    </p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>,</em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>,</em><em>)</em>) – Time points at which to
                                                        compute autocorrelation.</p></li>
                                                    <li><p><strong>states</strong> (<em>ndarray</em>) – Array of bath
                                                        states in z-projections format.</p></li>
                                                    <li><p><strong>gyro_e</strong> (<em>float</em><em> or </em><em>ndarray
                                                        with shape</em><em>
                                                        (</em><em>3</em><em>,</em><em>3</em><em>)</em>) –
                                                        <p>Gyromagnetic ratio of the central spin.</p>
                                                        <p><strong>OR</strong></p>
                                                        <p>Tensor corresponding to interaction between magnetic field
                                                            and central spin.</p>
                                                        </p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Autocorrelation of the bath spin noise along
                                                z-axis.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                                <dl class="py function">
                                    <dt id="pycce.calculators.correlation_function.noise_sampling">
                                        <code class="sig-name descname">noise_sampling</code><span
                                            class="sig-paren">(</span><em class="sig-param"><span
                                            class="n">clusters</span></em>, <em class="sig-param"><span
                                            class="n">bath</span></em>, <em class="sig-param"><span class="n">dm0</span></em>,
                                        <em class="sig-param"><span class="n">timespace</span></em>, <em
                                            class="sig-param"><span class="n">magnetic_field</span></em>, <em
                                            class="sig-param"><span class="n">zfs</span></em>, <em
                                            class="sig-param"><span class="n">gyro_e</span><span class="o">=</span><span
                                            class="default_value">- 17608.59705</span></em>, <em class="sig-param"><span
                                            class="n">nbstates</span><span class="o">=</span><span
                                            class="default_value">100</span></em>, <em class="sig-param"><span
                                            class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em>,
                                        <em class="sig-param"><span class="n">parallel_states</span><span
                                                class="o">=</span><span class="default_value">False</span></em>, <em
                                            class="sig-param"><span class="n">direct</span><span class="o">=</span><span
                                            class="default_value">False</span></em>, <em class="sig-param"><span
                                            class="n">parallel</span><span class="o">=</span><span
                                            class="default_value">False</span></em><span class="sig-paren">)</span><a
                                            class="headerlink"
                                            href="#pycce.calculators.correlation_function.noise_sampling"
                                            title="Permalink to this definition">¶</a></dt>
                                    <dd><p>Compute noise auto correlation function using generalized CCE with
                                        Monte-Carlo bath state sampling.</p>
                                        <dl class="field-list simple">
                                            <dt class="field-odd">Parameters</dt>
                                            <dd class="field-odd">
                                                <ul class="simple">
                                                    <li><p><strong>cluster</strong> (<em>dict</em>) – Clusters included
                                                        in different CCE orders of structure {int order:
                                                        ndarray([[i,j],[i,j]])}.</p></li>
                                                    <li><p><strong>bath</strong> (<a class="reference internal"
                                                                                     href="bath.html#pycce.bath.array.BathArray"
                                                                                     title="pycce.bath.array.BathArray"><em>BathArray</em></a>)
                                                        – Array of all bath spins.</p></li>
                                                    <li><p><strong>dm0</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>2s+1</em><em>, </em><em>2s+1</em><em>)</em>) – Density
                                                        matrix of the initial state of the central spin.</p></li>
                                                    <li><p><strong>timespace</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>t</em><em>,</em><em>)</em>) – Time points at which to
                                                        compute autocorrelation.</p></li>
                                                    <li><p><strong>magnetic_field</strong> (<em>ndarray with
                                                        shape</em><em> (</em><em>3</em><em>, </em><em>)</em>) – Magnetic
                                                        field of type mfield = np.array([Bx, By, Bz]).</p></li>
                                                    <li><p><strong>zfs</strong> (<em>ndarray with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – Zero Field
                                                        Splitting tensor of the central spin.</p></li>
                                                    <li><p><strong>gyro_e</strong> (<em>float</em><em> or </em><em>ndarray
                                                        with shape</em><em>
                                                        (</em><em>3</em><em>, </em><em>3</em><em>)</em>) – gyromagnetic
                                                        ratio of the central spin OR
                                                        tensor corresponding to interaction between magnetic field and
                                                        central spin.</p></li>
                                                    <li><p><strong>nbstates</strong> (<em>int</em>) – Number of random
                                                        bath states to sample.</p></li>
                                                    <li><p><strong>seed</strong> (<em>int</em>) – Seed for the RNG.</p>
                                                    </li>
                                                    <li><p><strong>parallel_states</strong> (<em>bool</em>) – True if
                                                        use MPI to parallelize the calculations of density matrix
                                                        for each random bath state.</p></li>
                                                    <li><p><strong>direct</strong> (<em>bool</em>) – True if use the
                                                        direct approach in cluster expansion.</p></li>
                                                    <li><p><strong>parallel</strong> (<em>bool</em>) – True if use MPI
                                                        for parallel computing of the cluster contributions.</p></li>
                                                </ul>
                                            </dd>
                                            <dt class="field-even">Returns</dt>
                                            <dd class="field-even"><p>Autocorrelation of the bath spin noise along
                                                z-axis.</p>
                                            </dd>
                                            <dt class="field-odd">Return type</dt>
                                            <dd class="field-odd"><p>ndarray with shape (t,)</p>
                                            </dd>
                                        </dl>
                                    </dd>
                                </dl>

                            </div>
                        </div>


                    </div>

                </div>
                <footer>
                    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
                        <a href="hamiltonian.html" class="btn btn-neutral float-right" title="Hamiltonian functions"
                           accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"
                                                               aria-hidden="true"></span></a>
                        <a href="dft.html" class="btn btn-neutral float-left" title="Interfacing with DFT output"
                           accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span>
                            Previous</a>
                    </div>

                    <hr/>

                    <div role="contentinfo">
                        <p>
                            &#169; Copyright 2021, Mykyta Onizhuk et al.

                        </p>
                    </div>


                    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a

                    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>

                    provided by <a href="https://readthedocs.org">Read the Docs</a>.

                </footer>
            </div>
        </div>

    </section>

</div>


<script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
    });
</script>


</body>
</html>